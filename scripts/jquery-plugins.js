/*Hammer.JS*/
; (function (t, e) { "use strict"; function n() { if (!i.READY) { i.event.determineEventTypes(); for (var t in i.gestures) i.gestures.hasOwnProperty(t) && i.detection.register(i.gestures[t]); i.event.onTouch(i.DOCUMENT, i.EVENT_MOVE, i.detection.detect), i.event.onTouch(i.DOCUMENT, i.EVENT_END, i.detection.detect), i.READY = !0 } } var i = function (t, e) { return new i.Instance(t, e || {}) }; i.defaults = { stop_browser_behavior: { userSelect: "none", touchAction: "none", touchCallout: "none", contentZooming: "none", userDrag: "none", tapHighlightColor: "rgba(0,0,0,0)" } }, i.HAS_POINTEREVENTS = navigator.pointerEnabled || navigator.msPointerEnabled, i.HAS_TOUCHEVENTS = "ontouchstart" in t, i.MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i, i.NO_MOUSEEVENTS = i.HAS_TOUCHEVENTS && navigator.userAgent.match(i.MOBILE_REGEX), i.EVENT_TYPES = {}, i.DIRECTION_DOWN = "down", i.DIRECTION_LEFT = "left", i.DIRECTION_UP = "up", i.DIRECTION_RIGHT = "right", i.POINTER_MOUSE = "mouse", i.POINTER_TOUCH = "touch", i.POINTER_PEN = "pen", i.EVENT_START = "start", i.EVENT_MOVE = "move", i.EVENT_END = "end", i.DOCUMENT = document, i.plugins = {}, i.READY = !1, i.Instance = function (t, e) { var r = this; return n(), this.element = t, this.enabled = !0, this.options = i.utils.extend(i.utils.extend({}, i.defaults), e || {}), this.options.stop_browser_behavior && i.utils.stopDefaultBrowserBehavior(this.element, this.options.stop_browser_behavior), i.event.onTouch(t, i.EVENT_START, function (t) { r.enabled && i.detection.startDetect(r, t) }), this }, i.Instance.prototype = { on: function (t, e) { for (var n = t.split(" "), i = 0; n.length > i; i++) this.element.addEventListener(n[i], e, !1); return this }, off: function (t, e) { for (var n = t.split(" "), i = 0; n.length > i; i++) this.element.removeEventListener(n[i], e, !1); return this }, trigger: function (t, e) { var n = i.DOCUMENT.createEvent("Event"); n.initEvent(t, !0, !0), n.gesture = e; var r = this.element; return i.utils.hasParent(e.target, r) && (r = e.target), r.dispatchEvent(n), this }, enable: function (t) { return this.enabled = t, this } }; var r = null, o = !1, s = !1; i.event = { bindDom: function (t, e, n) { for (var i = e.split(" "), r = 0; i.length > r; r++) t.addEventListener(i[r], n, !1) }, onTouch: function (t, e, n) { var a = this; this.bindDom(t, i.EVENT_TYPES[e], function (c) { var u = c.type.toLowerCase(); if (!u.match(/mouse/) || !s) { (u.match(/touch/) || u.match(/pointerdown/) || u.match(/mouse/) && 1 === c.which) && (o = !0), u.match(/touch|pointer/) && (s = !0); var h = 0; o && (i.HAS_POINTEREVENTS && e != i.EVENT_END ? h = i.PointerEvent.updatePointer(e, c) : u.match(/touch/) ? h = c.touches.length : s || (h = u.match(/up/) ? 0 : 1), h > 0 && e == i.EVENT_END ? e = i.EVENT_MOVE : h || (e = i.EVENT_END), h || null === r ? r = c : c = r, n.call(i.detection, a.collectEventData(t, e, c)), i.HAS_POINTEREVENTS && e == i.EVENT_END && (h = i.PointerEvent.updatePointer(e, c))), h || (r = null, o = !1, s = !1, i.PointerEvent.reset()) } }) }, determineEventTypes: function () { var t; t = i.HAS_POINTEREVENTS ? i.PointerEvent.getEvents() : i.NO_MOUSEEVENTS ? ["touchstart", "touchmove", "touchend touchcancel"] : ["touchstart mousedown", "touchmove mousemove", "touchend touchcancel mouseup"], i.EVENT_TYPES[i.EVENT_START] = t[0], i.EVENT_TYPES[i.EVENT_MOVE] = t[1], i.EVENT_TYPES[i.EVENT_END] = t[2] }, getTouchList: function (t) { return i.HAS_POINTEREVENTS ? i.PointerEvent.getTouchList() : t.touches ? t.touches : [{ identifier: 1, pageX: t.pageX, pageY: t.pageY, target: t.target }] }, collectEventData: function (t, e, n) { var r = this.getTouchList(n, e), o = i.POINTER_TOUCH; return (n.type.match(/mouse/) || i.PointerEvent.matchType(i.POINTER_MOUSE, n)) && (o = i.POINTER_MOUSE), { center: i.utils.getCenter(r), timeStamp: (new Date).getTime(), target: n.target, touches: r, eventType: e, pointerType: o, srcEvent: n, preventDefault: function () { this.srcEvent.preventManipulation && this.srcEvent.preventManipulation(), this.srcEvent.preventDefault && this.srcEvent.preventDefault() }, stopPropagation: function () { this.srcEvent.stopPropagation() }, stopDetect: function () { return i.detection.stopDetect() } } } }, i.PointerEvent = { pointers: {}, getTouchList: function () { var t = this, e = []; return Object.keys(t.pointers).sort().forEach(function (n) { e.push(t.pointers[n]) }), e }, updatePointer: function (t, e) { return t == i.EVENT_END ? this.pointers = {} : (e.identifier = e.pointerId, this.pointers[e.pointerId] = e), Object.keys(this.pointers).length }, matchType: function (t, e) { if (!e.pointerType) return !1; var n = {}; return n[i.POINTER_MOUSE] = e.pointerType == e.MSPOINTER_TYPE_MOUSE || e.pointerType == i.POINTER_MOUSE, n[i.POINTER_TOUCH] = e.pointerType == e.MSPOINTER_TYPE_TOUCH || e.pointerType == i.POINTER_TOUCH, n[i.POINTER_PEN] = e.pointerType == e.MSPOINTER_TYPE_PEN || e.pointerType == i.POINTER_PEN, n[t] }, getEvents: function () { return ["pointerdown MSPointerDown", "pointermove MSPointerMove", "pointerup pointercancel MSPointerUp MSPointerCancel"] }, reset: function () { this.pointers = {} } }, i.utils = { extend: function (t, n, i) { for (var r in n) t[r] !== e && i || (t[r] = n[r]); return t }, hasParent: function (t, e) { for (; t;) { if (t == e) return !0; t = t.parentNode } return !1 }, getCenter: function (t) { for (var e = [], n = [], i = 0, r = t.length; r > i; i++) e.push(t[i].pageX), n.push(t[i].pageY); return { pageX: (Math.min.apply(Math, e) + Math.max.apply(Math, e)) / 2, pageY: (Math.min.apply(Math, n) + Math.max.apply(Math, n)) / 2 } }, getVelocity: function (t, e, n) { return { x: Math.abs(e / t) || 0, y: Math.abs(n / t) || 0 } }, getAngle: function (t, e) { var n = e.pageY - t.pageY, i = e.pageX - t.pageX; return 180 * Math.atan2(n, i) / Math.PI }, getDirection: function (t, e) { var n = Math.abs(t.pageX - e.pageX), r = Math.abs(t.pageY - e.pageY); return n >= r ? t.pageX - e.pageX > 0 ? i.DIRECTION_LEFT : i.DIRECTION_RIGHT : t.pageY - e.pageY > 0 ? i.DIRECTION_UP : i.DIRECTION_DOWN }, getDistance: function (t, e) { var n = e.pageX - t.pageX, i = e.pageY - t.pageY; return Math.sqrt(n * n + i * i) }, getScale: function (t, e) { return t.length >= 2 && e.length >= 2 ? this.getDistance(e[0], e[1]) / this.getDistance(t[0], t[1]) : 1 }, getRotation: function (t, e) { return t.length >= 2 && e.length >= 2 ? this.getAngle(e[1], e[0]) - this.getAngle(t[1], t[0]) : 0 }, isVertical: function (t) { return t == i.DIRECTION_UP || t == i.DIRECTION_DOWN }, stopDefaultBrowserBehavior: function (t, e) { var n, i = ["webkit", "khtml", "moz", "ms", "o", ""]; if (e && t.style) { for (var r = 0; i.length > r; r++) for (var o in e) e.hasOwnProperty(o) && (n = o, i[r] && (n = i[r] + n.substring(0, 1).toUpperCase() + n.substring(1)), t.style[n] = e[o]); "none" == e.userSelect && (t.onselectstart = function () { return !1 }) } } }, i.detection = { gestures: [], current: null, previous: null, stopped: !1, startDetect: function (t, e) { this.current || (this.stopped = !1, this.current = { inst: t, startEvent: i.utils.extend({}, e), lastEvent: !1, name: "" }, this.detect(e)) }, detect: function (t) { if (this.current && !this.stopped) { t = this.extendEventData(t); for (var e = this.current.inst.options, n = 0, r = this.gestures.length; r > n; n++) { var o = this.gestures[n]; if (!this.stopped && e[o.name] !== !1 && o.handler.call(o, t, this.current.inst) === !1) { this.stopDetect(); break } } return this.current && (this.current.lastEvent = t), t.eventType == i.EVENT_END && !t.touches.length - 1 && this.stopDetect(), t } }, stopDetect: function () { this.previous = i.utils.extend({}, this.current), this.current = null, this.stopped = !0 }, extendEventData: function (t) { var e = this.current.startEvent; if (e && (t.touches.length != e.touches.length || t.touches === e.touches)) { e.touches = []; for (var n = 0, r = t.touches.length; r > n; n++) e.touches.push(i.utils.extend({}, t.touches[n])) } var o = t.timeStamp - e.timeStamp, s = t.center.pageX - e.center.pageX, a = t.center.pageY - e.center.pageY, c = i.utils.getVelocity(o, s, a); return i.utils.extend(t, { deltaTime: o, deltaX: s, deltaY: a, velocityX: c.x, velocityY: c.y, distance: i.utils.getDistance(e.center, t.center), angle: i.utils.getAngle(e.center, t.center), direction: i.utils.getDirection(e.center, t.center), scale: i.utils.getScale(e.touches, t.touches), rotation: i.utils.getRotation(e.touches, t.touches), startEvent: e }), t }, register: function (t) { var n = t.defaults || {}; return n[t.name] === e && (n[t.name] = !0), i.utils.extend(i.defaults, n, !0), t.index = t.index || 1e3, this.gestures.push(t), this.gestures.sort(function (t, e) { return t.index < e.index ? -1 : t.index > e.index ? 1 : 0 }), this.gestures } }, i.gestures = i.gestures || {}, i.gestures.Hold = { name: "hold", index: 10, defaults: { hold_timeout: 500, hold_threshold: 1 }, timer: null, handler: function (t, e) { switch (t.eventType) { case i.EVENT_START: clearTimeout(this.timer), i.detection.current.name = this.name, this.timer = setTimeout(function () { "hold" == i.detection.current.name && e.trigger("hold", t) }, e.options.hold_timeout); break; case i.EVENT_MOVE: t.distance > e.options.hold_threshold && clearTimeout(this.timer); break; case i.EVENT_END: clearTimeout(this.timer) } } }, i.gestures.Tap = { name: "tap", index: 100, defaults: { tap_max_touchtime: 250, tap_max_distance: 10, tap_always: !0, doubletap_distance: 20, doubletap_interval: 300 }, handler: function (t, e) { if (t.eventType == i.EVENT_END) { var n = i.detection.previous, r = !1; if (t.deltaTime > e.options.tap_max_touchtime || t.distance > e.options.tap_max_distance) return; n && "tap" == n.name && t.timeStamp - n.lastEvent.timeStamp < e.options.doubletap_interval && t.distance < e.options.doubletap_distance && (e.trigger("doubletap", t), r = !0), (!r || e.options.tap_always) && (i.detection.current.name = "tap", e.trigger(i.detection.current.name, t)) } } }, i.gestures.Swipe = { name: "swipe", index: 40, defaults: { swipe_max_touches: 1, swipe_velocity: .7 }, handler: function (t, e) { if (t.eventType == i.EVENT_END) { if (e.options.swipe_max_touches > 0 && t.touches.length > e.options.swipe_max_touches) return; (t.velocityX > e.options.swipe_velocity || t.velocityY > e.options.swipe_velocity) && (e.trigger(this.name, t), e.trigger(this.name + t.direction, t)) } } }, i.gestures.Drag = { name: "drag", index: 50, defaults: { drag_min_distance: 10, drag_max_touches: 1, drag_block_horizontal: !1, drag_block_vertical: !1, drag_lock_to_axis: !1, drag_lock_min_distance: 25 }, triggered: !1, handler: function (t, n) { if (i.detection.current.name != this.name && this.triggered) return n.trigger(this.name + "end", t), this.triggered = !1, e; if (!(n.options.drag_max_touches > 0 && t.touches.length > n.options.drag_max_touches)) switch (t.eventType) { case i.EVENT_START: this.triggered = !1; break; case i.EVENT_MOVE: if (t.distance < n.options.drag_min_distance && i.detection.current.name != this.name) return; i.detection.current.name = this.name, (i.detection.current.lastEvent.drag_locked_to_axis || n.options.drag_lock_to_axis && n.options.drag_lock_min_distance <= t.distance) && (t.drag_locked_to_axis = !0); var r = i.detection.current.lastEvent.direction; t.drag_locked_to_axis && r !== t.direction && (t.direction = i.utils.isVertical(r) ? 0 > t.deltaY ? i.DIRECTION_UP : i.DIRECTION_DOWN : 0 > t.deltaX ? i.DIRECTION_LEFT : i.DIRECTION_RIGHT), this.triggered || (n.trigger(this.name + "start", t), this.triggered = !0), n.trigger(this.name, t), n.trigger(this.name + t.direction, t), (n.options.drag_block_vertical && i.utils.isVertical(t.direction) || n.options.drag_block_horizontal && !i.utils.isVertical(t.direction)) && t.preventDefault(); break; case i.EVENT_END: this.triggered && n.trigger(this.name + "end", t), this.triggered = !1 } } }, i.gestures.Transform = { name: "transform", index: 45, defaults: { transform_min_scale: .01, transform_min_rotation: 1, transform_always_block: !1 }, triggered: !1, handler: function (t, n) { if (i.detection.current.name != this.name && this.triggered) return n.trigger(this.name + "end", t), this.triggered = !1, e; if (!(2 > t.touches.length)) switch (n.options.transform_always_block && t.preventDefault(), t.eventType) { case i.EVENT_START: this.triggered = !1; break; case i.EVENT_MOVE: var r = Math.abs(1 - t.scale), o = Math.abs(t.rotation); if (n.options.transform_min_scale > r && n.options.transform_min_rotation > o) return; i.detection.current.name = this.name, this.triggered || (n.trigger(this.name + "start", t), this.triggered = !0), n.trigger(this.name, t), o > n.options.transform_min_rotation && n.trigger("rotate", t), r > n.options.transform_min_scale && (n.trigger("pinch", t), n.trigger("pinch" + (1 > t.scale ? "in" : "out"), t)); break; case i.EVENT_END: this.triggered && n.trigger(this.name + "end", t), this.triggered = !1 } } }, i.gestures.Touch = { name: "touch", index: -1 / 0, defaults: { prevent_default: !1, prevent_mouseevents: !1 }, handler: function (t, n) { return n.options.prevent_mouseevents && t.pointerType == i.POINTER_MOUSE ? (t.stopDetect(), e) : (n.options.prevent_default && t.preventDefault(), t.eventType == i.EVENT_START && n.trigger(this.name, t), e) } }, i.gestures.Release = { name: "release", index: 1 / 0, handler: function (t, e) { t.eventType == i.EVENT_END && e.trigger(this.name, t) } }, "object" == typeof module && "object" == typeof module.exports ? module.exports = i : (t.Hammer = i, "function" == typeof t.define && t.define.amd && t.define("hammer", [], function () { return i })) })(this), function (t, e) { "use strict"; t !== e && (Hammer.event.bindDom = function (n, i, r) { t(n).on(i, function (t) { var n = t.originalEvent || t; n.pageX === e && (n.pageX = t.pageX, n.pageY = t.pageY), n.target || (n.target = t.target), n.which === e && (n.which = n.button), n.preventDefault || (n.preventDefault = t.preventDefault), n.stopPropagation || (n.stopPropagation = t.stopPropagation), r.call(this, n) }) }, Hammer.Instance.prototype.on = function (e, n) { return t(this.element).on(e, n) }, Hammer.Instance.prototype.off = function (e, n) { return t(this.element).off(e, n) }, Hammer.Instance.prototype.trigger = function (e, n) { var i = t(this.element); return i.has(n.target).length && (i = t(n.target)), i.trigger({ type: e, gesture: n }) }, t.fn.hammer = function (e) { return this.each(function () { var n = t(this), i = n.data("hammer"); i ? i && e && Hammer.utils.extend(i.options, e) : n.data("hammer", new Hammer(this, e || {})) }) }) }(window.jQuery || window.Zepto);

/*Begin underscore.min.js*/
;(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=r.unshift,l=i.toString,c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){if(e instanceof T)return e;if(!(this instanceof T))return new T(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(e==null)return;if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return e==null?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return e==null?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return e==null?r:(N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return e==null?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return e==null?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return e==null?n:b&&e.indexOf===b?e.indexOf(t)!=-1:(n=C(e,function(e){return e===t}),n)},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-Infinity;var r={computed:-Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return Infinity;var r={computed:Infinity};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){n=n==null?T.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return t!=null&&!n?u.call(e,0,t):e[0]},T.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},T.last=function(e,t,n){return t!=null&&!n?u.call(e,Math.max(e.length-t,0)):e[e.length-1]},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){if(t?!r||o[o.length-1]!==n:!T.contains(o,n))o.push(n),s.push(e[r])}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t);for(var r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=T.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return t.length==0&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;var f=function(){i=null,o&&(u=e.apply(n,r)),a()};return i||(i=setTimeout(f,t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]==null&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if(i=="[object Array]"){o=e.length,u=o==t.length;if(u)while(o--)if(!(u=M(e[o],t[o],n,r)))break}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)){o++;if(!(u=T.has(t,c)&&M(e[c],t[c],n,r)))break}if(u){for(c in t)if(T.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(e==null)return!0;if(T.isArray(e)||T.isString(e))return e.length===0;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&e.nodeType===1},T.isArray=E||function(e){return l.call(e)=="[object Array]"},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),typeof /./!="function"&&(T.isFunction=function(e){return typeof e=="function"}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return e===!0||e===!1||l.call(e)=="[object Boolean]"},T.isNull=function(e){return e===null},T.isUndefined=function(e){return e===void 0},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return t==null&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(e==null)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","  ":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);

/*Begin underscore.tap.min.js*/
_=_||{};_.tap=function(e,t,n){n=n||400;t?e.on("tap",t,function(e){var t=$(e.currentTarget),r=t.data("debounce");if(!r){r=_.debounce(function(e){e.removeClass("tap")},n);t.data("debounce",r)}t.addClass("tap");r(t)}):e.each(function(e,t){var r=_.debounce(function(e){e.removeClass("tap")},n);$(t).on("tap",function(e){var t=$(e.currentTarget);t.addClass("tap");r(t)})})};

var $html = $('html'), $container = $('#wraper');
// Add touch functionality.
if (Hammer.HAS_TOUCHEVENTS) {
	$container.hammer({drag_lock_to_axis: true});
	_.tap($html, 'a,button,[data-tap]');
}

// Add touch or mouse class to html element.
$html.addClass(Hammer.HAS_TOUCHEVENTS ? 'touch' : 'mouse');

/* sifter.js*/
; (function (root, factory) { if (typeof define === 'function' && define.amd) { define('sifter', factory) } else if (typeof exports === 'object') { module.exports = factory() } else { root.Sifter = factory() } }(this, function () { var Sifter = function (items, settings) { this.items = items; this.settings = settings || { diacritics: true } }; Sifter.prototype.tokenize = function (query) { query = trim(String(query || '').toLowerCase()); if (!query || !query.length) return []; var i, n, regex, letter; var tokens = []; var words = query.split(/ +/); for (i = 0, n = words.length; i < n; i++) { regex = escape_regex(words[i]); if (this.settings.diacritics) { for (letter in DIACRITICS) { if (DIACRITICS.hasOwnProperty(letter)) { regex = regex.replace(new RegExp(letter, 'g'), DIACRITICS[letter]) } } } tokens.push({ string: words[i], regex: new RegExp(regex, 'i') }) } return tokens }; Sifter.prototype.iterator = function (object, callback) { var iterator; if (is_array(object)) { iterator = Array.prototype.forEach || function (callback) { for (var i = 0, n = this.length; i < n; i++) { callback(this[i], i, this) } } } else { iterator = function (callback) { for (var key in this) { if (this.hasOwnProperty(key)) { callback(this[key], key, this) } } } } iterator.apply(object, [callback]) }; Sifter.prototype.getScoreFunction = function (search, options) { var self, fields, tokens, token_count; self = this; search = self.prepareSearch(search, options); tokens = search.tokens; fields = search.options.fields; token_count = tokens.length; var scoreValue = function (value, token) { var score, pos; if (!value) return 0; value = String(value || ''); pos = value.search(token.regex); if (pos === -1) return 0; score = token.string.length / value.length; if (pos === 0) score += 0.5; return score }; var scoreObject = (function () { var field_count = fields.length; if (!field_count) { return function () { return 0 } } if (field_count === 1) { return function (token, data) { return scoreValue(data[fields[0]], token) } } return function (token, data) { for (var i = 0, sum = 0; i < field_count; i++) { sum += scoreValue(data[fields[i]], token) } return sum / field_count } })(); if (!token_count) { return function () { return 0 } } if (token_count === 1) { return function (data) { return scoreObject(tokens[0], data) } } if (search.options.conjunction === 'and') { return function (data) { var score; for (var i = 0, sum = 0; i < token_count; i++) { score = scoreObject(tokens[i], data); if (score <= 0) return 0; sum += score } return sum / token_count } } else { return function (data) { for (var i = 0, sum = 0; i < token_count; i++) { sum += scoreObject(tokens[i], data) } return sum / token_count } } }; Sifter.prototype.getSortFunction = function (search, options) { var i, n, self, field, fields, fields_count, multiplier, multipliers, get_field, implicit_score, sort; self = this; search = self.prepareSearch(search, options); sort = (!search.query && options.sort_empty) || options.sort; get_field = function (name, result) { if (name === '$score') return result.score; return self.items[result.id][name] }; fields = []; if (sort) { for (i = 0, n = sort.length; i < n; i++) { if (search.query || sort[i].field !== '$score') { fields.push(sort[i]) } } } if (search.query) { implicit_score = true; for (i = 0, n = fields.length; i < n; i++) { if (fields[i].field === '$score') { implicit_score = false; break } } if (implicit_score) { fields.unshift({ field: '$score', direction: 'desc' }) } } else { for (i = 0, n = fields.length; i < n; i++) { if (fields[i].field === '$score') { fields.splice(i, 1); break } } } multipliers = []; for (i = 0, n = fields.length; i < n; i++) { multipliers.push(fields[i].direction === 'desc' ? -1 : 1) } fields_count = fields.length; if (!fields_count) { return null } else if (fields_count === 1) { field = fields[0].field; multiplier = multipliers[0]; return function (a, b) { return multiplier * cmp(get_field(field, a), get_field(field, b)) } } else { return function (a, b) { var i, result, a_value, b_value, field; for (i = 0; i < fields_count; i++) { field = fields[i].field; result = multipliers[i] * cmp(get_field(field, a), get_field(field, b)); if (result) return result } return 0 } } }; Sifter.prototype.prepareSearch = function (query, options) { if (typeof query === 'object') return query; options = extend({}, options); var option_fields = options.fields; var option_sort = options.sort; var option_sort_empty = options.sort_empty; if (option_fields && !is_array(option_fields)) options.fields = [option_fields]; if (option_sort && !is_array(option_sort)) options.sort = [option_sort]; if (option_sort_empty && !is_array(option_sort_empty)) options.sort_empty = [option_sort_empty]; return { options: options, query: String(query || '').toLowerCase(), tokens: this.tokenize(query), total: 0, items: [] } }; Sifter.prototype.search = function (query, options) { var self = this, value, score, search, calculateScore; var fn_sort; var fn_score; search = this.prepareSearch(query, options); options = search.options; query = search.query; fn_score = options.score || self.getScoreFunction(search); if (query.length) { self.iterator(self.items, function (item, id) { score = fn_score(item); if (options.filter === false || score > 0) { search.items.push({ 'score': score, 'id': id }) } }) } else { self.iterator(self.items, function (item, id) { search.items.push({ 'score': 1, 'id': id }) }) } fn_sort = self.getSortFunction(search, options); if (fn_sort) search.items.sort(fn_sort); search.total = search.items.length; if (typeof options.limit === 'number') { search.items = search.items.slice(0, options.limit) } return search }; var cmp = function (a, b) { if (typeof a === 'number' && typeof b === 'number') { return a > b ? 1 : (a < b ? -1 : 0) } a = String(a || '').toLowerCase(); b = String(b || '').toLowerCase(); if (a > b) return 1; if (b > a) return -1; return 0 }; var extend = function (a, b) { var i, n, k, object; for (i = 1, n = arguments.length; i < n; i++) { object = arguments[i]; if (!object) continue; for (k in object) { if (object.hasOwnProperty(k)) { a[k] = object[k] } } } return a }; var trim = function (str) { return (str + '').replace(/^\s+|\s+$|/g, '') }; var escape_regex = function (str) { return (str + '').replace(/([.?*+^$[\]\\(){}|-])/g, '\\$1') }; var is_array = Array.isArray || ($ && $.isArray) || function (object) { return Object.prototype.toString.call(object) === '[object Array]' }; var DIACRITICS = { 'a': '[aÀÁÂÃÄÅàáâãäå]', 'c': '[cÇçćĆčČ]', 'd': '[dđĐ]', 'e': '[eÈÉÊËèéêë]', 'i': '[iÌÍÎÏìíîï]', 'n': '[nÑñ]', 'o': '[oÒÓÔÕÕÖØòóôõöø]', 's': '[sŠš]', 'u': '[uÙÚÛÜùúûü]', 'y': '[yŸÿý]', 'z': '[zŽž]' }; return Sifter })); (function (root, factory) { if (typeof define === 'function' && define.amd) { define('microplugin', factory) } else if (typeof exports === 'object') { module.exports = factory() } else { root.MicroPlugin = factory() } }(this, function () { var MicroPlugin = {}; MicroPlugin.mixin = function (Interface) { Interface.plugins = {}; Interface.prototype.initializePlugins = function (plugins) { var i, n, key; var self = this; var queue = []; self.plugins = { names: [], settings: {}, requested: {}, loaded: {} }; if (utils.isArray(plugins)) { for (i = 0, n = plugins.length; i < n; i++) { if (typeof plugins[i] === 'string') { queue.push(plugins[i]) } else { self.plugins.settings[plugins[i].name] = plugins[i].options; queue.push(plugins[i].name) } } } else if (plugins) { for (key in plugins) { if (plugins.hasOwnProperty(key)) { self.plugins.settings[key] = plugins[key]; queue.push(key) } } } while (queue.length) { self.require(queue.shift()) } }; Interface.prototype.loadPlugin = function (name) { var self = this; var plugins = self.plugins; var plugin = Interface.plugins[name]; if (!Interface.plugins.hasOwnProperty(name)) { throw new Error('Unable to find "' + name + '" plugin'); } plugins.requested[name] = true; plugins.loaded[name] = plugin.fn.apply(self, [self.plugins.settings[name] || {}]); plugins.names.push(name) }; Interface.prototype.require = function (name) { var self = this; var plugins = self.plugins; if (!self.plugins.loaded.hasOwnProperty(name)) { if (plugins.requested[name]) { throw new Error('Plugin has circular dependency ("' + name + '")'); } self.loadPlugin(name) } return plugins.loaded[name] }; Interface.define = function (name, fn) { Interface.plugins[name] = { 'name': name, 'fn': fn } } }; var utils = { isArray: Array.isArray || function (vArg) { return Object.prototype.toString.call(vArg) === '[object Array]' } }; return MicroPlugin })); (function (root, factory) { if (typeof define === 'function' && define.amd) { define('selectize', ['jquery', 'sifter', 'microplugin'], factory) } else { root.Selectize = factory(root.jQuery, root.Sifter, root.MicroPlugin) } }(this, function ($, Sifter, MicroPlugin) { 'use strict'; var highlight = function ($element, pattern) { if (typeof pattern === 'string' && !pattern.length) return; var regex = (typeof pattern === 'string') ? new RegExp(pattern, 'i') : pattern; var highlight = function (node) { var skip = 0; if (node.nodeType === 3) { var pos = node.data.search(regex); if (pos >= 0 && node.data.length > 0) { var match = node.data.match(regex); var spannode = document.createElement('span'); spannode.className = 'highlight'; var middlebit = node.splitText(pos); var endbit = middlebit.splitText(match[0].length); var middleclone = middlebit.cloneNode(true); spannode.appendChild(middleclone); middlebit.parentNode.replaceChild(spannode, middlebit); skip = 1 } } else if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) { for (var i = 0; i < node.childNodes.length; ++i) { i += highlight(node.childNodes[i]) } } return skip }; return $element.each(function () { highlight(this) }) }; var MicroEvent = function () { }; MicroEvent.prototype = { on: function (event, fct) { this._events = this._events || {}; this._events[event] = this._events[event] || []; this._events[event].push(fct) }, off: function (event, fct) { var n = arguments.length; if (n === 0) return delete this._events; if (n === 1) return delete this._events[event]; this._events = this._events || {}; if (event in this._events === false) return; this._events[event].splice(this._events[event].indexOf(fct), 1) }, trigger: function (event) { this._events = this._events || {}; if (event in this._events === false) return; for (var i = 0; i < this._events[event].length; i++) { this._events[event][i].apply(this, Array.prototype.slice.call(arguments, 1)) } } }; MicroEvent.mixin = function (destObject) { var props = ['on', 'off', 'trigger']; for (var i = 0; i < props.length; i++) { destObject.prototype[props[i]] = MicroEvent.prototype[props[i]] } }; var IS_MAC = /Mac/.test(navigator.userAgent); var KEY_A = 65; var KEY_COMMA = 188; var KEY_RETURN = 13; var KEY_ESC = 27; var KEY_LEFT = 37; var KEY_UP = 38; var KEY_RIGHT = 39; var KEY_DOWN = 40; var KEY_BACKSPACE = 8; var KEY_DELETE = 46; var KEY_SHIFT = 16; var KEY_CMD = IS_MAC ? 91 : 17; var KEY_CTRL = IS_MAC ? 18 : 17; var KEY_TAB = 9; var TAG_SELECT = 1; var TAG_INPUT = 2; var isset = function (object) { return typeof object !== 'undefined' }; var hash_key = function (value) { if (typeof value === 'undefined' || value === null) return ''; if (typeof value === 'boolean') return value ? '1' : '0'; return value + '' }; var escape_html = function (str) { return (str + '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;') }; var escape_replace = function (str) { return (str + '').replace(/\$/g, '$$$$') }; var hook = {}; hook.before = function (self, method, fn) { var original = self[method]; self[method] = function () { fn.apply(self, arguments); return original.apply(self, arguments) } }; hook.after = function (self, method, fn) { var original = self[method]; self[method] = function () { var result = original.apply(self, arguments); fn.apply(self, arguments); return result } }; var build_hash_table = function (key, objects) { if (!$.isArray(objects)) return objects; var i, n, table = {}; for (i = 0, n = objects.length; i < n; i++) { if (objects[i].hasOwnProperty(key)) { table[objects[i][key]] = objects[i] } } return table }; var once = function (fn) { var called = false; return function () { if (called) return; called = true; fn.apply(this, arguments) } }; var debounce = function (fn, delay) { var timeout; return function () { var self = this; var args = arguments; window.clearTimeout(timeout); timeout = window.setTimeout(function () { fn.apply(self, args) }, delay) } }; var debounce_events = function (self, types, fn) { var type; var trigger = self.trigger; var event_args = {}; self.trigger = function () { var type = arguments[0]; if (types.indexOf(type) !== -1) { event_args[type] = arguments } else { return trigger.apply(self, arguments) } }; fn.apply(self, []); self.trigger = trigger; for (type in event_args) { if (event_args.hasOwnProperty(type)) { trigger.apply(self, event_args[type]) } } }; var watchChildEvent = function ($parent, event, selector, fn) { $parent.on(event, selector, function (e) { var child = e.target; while (child && child.parentNode !== $parent[0]) { child = child.parentNode } e.currentTarget = child; return fn.apply(this, [e]) }) }; var getSelection = function (input) { var result = {}; if ('selectionStart' in input) { result.start = input.selectionStart; result.length = input.selectionEnd - result.start } else if (document.selection) { input.focus(); var sel = document.selection.createRange(); var selLen = document.selection.createRange().text.length; sel.moveStart('character', -input.value.length); result.start = sel.text.length - selLen; result.length = selLen } return result }; var transferStyles = function ($from, $to, properties) { var i, n, styles = {}; if (properties) { for (i = 0, n = properties.length; i < n; i++) { styles[properties[i]] = $from.css(properties[i]) } } else { styles = $from.css() } $to.css(styles) }; var measureString = function (str, $parent) { var $test = $('<test>').css({ position: 'absolute', top: -99999, left: -99999, width: 'auto', padding: 0, whiteSpace: 'pre' }).text(str).appendTo('body'); transferStyles($parent, $test, ['letterSpacing', 'fontSize', 'fontFamily', 'fontWeight', 'textTransform']); var width = $test.width(); $test.remove(); return width }; var autoGrow = function ($input) { var update = function (e) { var value, keyCode, printable, placeholder, width; var shift, character, selection; e = e || window.event || {}; if (e.metaKey || e.altKey) return; if ($input.data('grow') === false) return; value = $input.val(); if (e.type && e.type.toLowerCase() === 'keydown') { keyCode = e.keyCode; printable = ((keyCode >= 97 && keyCode <= 122) || (keyCode >= 65 && keyCode <= 90) || (keyCode >= 48 && keyCode <= 57) || keyCode === 32); if (keyCode === KEY_DELETE || keyCode === KEY_BACKSPACE) { selection = getSelection($input[0]); if (selection.length) { value = value.substring(0, selection.start) + value.substring(selection.start + selection.length) } else if (keyCode === KEY_BACKSPACE && selection.start) { value = value.substring(0, selection.start - 1) + value.substring(selection.start + 1) } else if (keyCode === KEY_DELETE && typeof selection.start !== 'undefined') { value = value.substring(0, selection.start) + value.substring(selection.start + 1) } } else if (printable) { shift = e.shiftKey; character = String.fromCharCode(e.keyCode); if (shift) character = character.toUpperCase(); else character = character.toLowerCase(); value += character } } placeholder = $input.attr('placeholder') || ''; if (!value.length && placeholder.length) { value = placeholder } width = measureString(value, $input) + 4; if (width !== $input.width()) { $input.width(width); $input.triggerHandler('resize') } }; $input.on('keydown keyup update blur', update); update() }; var Selectize = function ($input, settings) { var key, i, n, dir, input, self = this; input = $input[0]; input.selectize = self; dir = window.getComputedStyle ? window.getComputedStyle(input, null).getPropertyValue('direction') : input.currentStyle && input.currentStyle.direction; dir = dir || $input.parents('[dir]:first').attr('dir') || ''; $.extend(self, { settings: settings, $input: $input, tagType: input.tagName.toLowerCase() === 'select' ? TAG_SELECT : TAG_INPUT, rtl: /rtl/i.test(dir), eventNS: '.selectize' + (++Selectize.count), highlightedValue: null, isOpen: false, isDisabled: false, isRequired: $input.is('[required]'), isInvalid: false, isLocked: false, isFocused: false, isInputHidden: false, isSetup: false, isShiftDown: false, isCmdDown: false, isCtrlDown: false, ignoreFocus: false, ignoreHover: false, hasOptions: false, currentResults: null, lastValue: '', caretPos: 0, loading: 0, loadedSearches: {}, $activeOption: null, $activeItems: [], optgroups: {}, options: {}, userOptions: {}, items: [], renderCache: {}, onSearchChange: debounce(self.onSearchChange, settings.loadThrottle) }); self.sifter = new Sifter(this.options, { diacritics: settings.diacritics }); $.extend(self.options, build_hash_table(settings.valueField, settings.options)); delete self.settings.options; $.extend(self.optgroups, build_hash_table(settings.optgroupValueField, settings.optgroups)); delete self.settings.optgroups; self.settings.mode = self.settings.mode || (self.settings.maxItems === 1 ? 'single' : 'multi'); if (typeof self.settings.hideSelected !== 'boolean') { self.settings.hideSelected = self.settings.mode === 'multi' } self.initializePlugins(self.settings.plugins); self.setupCallbacks(); self.setupTemplates(); self.setup() }; MicroEvent.mixin(Selectize); MicroPlugin.mixin(Selectize); $.extend(Selectize.prototype, { setup: function () { var self = this; var settings = self.settings; var eventNS = self.eventNS; var $window = $(window); var $document = $(document); var $wrapper; var $control; var $control_input; var $dropdown; var $dropdown_content; var $dropdown_parent; var inputMode; var timeout_blur; var timeout_focus; var tab_index; var classes; var classes_plugins; inputMode = self.settings.mode; tab_index = self.$input.attr('tabindex') || ''; classes = self.$input.attr('class') || ''; $wrapper = $('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode); $control = $('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper); $control_input = $('<input type="text" autocomplete="off">').appendTo($control).attr('tabindex', tab_index); $dropdown_parent = $(settings.dropdownParent || $wrapper); $dropdown = $('<div>').addClass(settings.dropdownClass).addClass(classes).addClass(inputMode).hide().appendTo($dropdown_parent); $dropdown_content = $('<div>').addClass(settings.dropdownContentClass).appendTo($dropdown); $wrapper.css({ width: self.$input[0].style.width }); if (self.plugins.names.length) { classes_plugins = 'plugin-' + self.plugins.names.join(' plugin-'); $wrapper.addClass(classes_plugins); $dropdown.addClass(classes_plugins) } if ((settings.maxItems === null || settings.maxItems > 1) && self.tagType === TAG_SELECT) { self.$input.attr('multiple', 'multiple') } if (self.settings.placeholder) { $control_input.attr('placeholder', settings.placeholder) } self.$wrapper = $wrapper; self.$control = $control; self.$control_input = $control_input; self.$dropdown = $dropdown; self.$dropdown_content = $dropdown_content; $dropdown.on('mouseenter', '[data-selectable]', function () { return self.onOptionHover.apply(self, arguments) }); $dropdown.on('mousedown', '[data-selectable]', function () { return self.onOptionSelect.apply(self, arguments) }); watchChildEvent($control, 'mousedown', '*:not(input)', function () { return self.onItemSelect.apply(self, arguments) }); autoGrow($control_input); $control.on({ mousedown: function () { return self.onMouseDown.apply(self, arguments) }, click: function () { return self.onClick.apply(self, arguments) } }); $control_input.on({ mousedown: function (e) { e.stopPropagation() }, keydown: function () { return self.onKeyDown.apply(self, arguments) }, keyup: function () { return self.onKeyUp.apply(self, arguments) }, keypress: function () { return self.onKeyPress.apply(self, arguments) }, resize: function () { self.positionDropdown.apply(self, []) }, blur: function () { return self.onBlur.apply(self, arguments) }, focus: function () { return self.onFocus.apply(self, arguments) } }); $document.on('keydown' + eventNS, function (e) { self.isCmdDown = e[IS_MAC ? 'metaKey' : 'ctrlKey']; self.isCtrlDown = e[IS_MAC ? 'altKey' : 'ctrlKey']; self.isShiftDown = e.shiftKey }); $document.on('keyup' + eventNS, function (e) { if (e.keyCode === KEY_CTRL) self.isCtrlDown = false; if (e.keyCode === KEY_SHIFT) self.isShiftDown = false; if (e.keyCode === KEY_CMD) self.isCmdDown = false }); $document.on('mousedown' + eventNS, function (e) { if (self.isFocused) { if (e.target === self.$dropdown[0] || e.target.parentNode === self.$dropdown[0]) { return false } if (!self.$control.has(e.target).length && e.target !== self.$control[0]) { self.blur() } } }); $window.on(['scroll' + eventNS, 'resize' + eventNS].join(' '), function () { if (self.isOpen) { self.positionDropdown.apply(self, arguments) } }); $window.on('mousemove' + eventNS, function () { self.ignoreHover = false }); this.revertSettings = { $children: self.$input.children().detach(), tabindex: self.$input.attr('tabindex') }; self.$input.attr('tabindex', -1).hide().after(self.$wrapper); if ($.isArray(settings.items)) { self.setValue(settings.items); delete settings.items } if (self.$input[0].validity) { self.$input.on('invalid' + eventNS, function (e) { e.preventDefault(); self.isInvalid = true; self.refreshState() }) } self.updateOriginalInput(); self.refreshItems(); self.refreshState(); self.updatePlaceholder(); self.isSetup = true; if (self.$input.is(':disabled')) { self.disable() } self.on('change', this.onChange); self.trigger('initialize'); if (settings.preload) { self.onSearchChange('') } }, setupTemplates: function () { var self = this; var field_label = self.settings.labelField; var field_optgroup = self.settings.optgroupLabelField; var templates = { 'optgroup': function (data) { return '<div class="optgroup">' + data.html + '</div>' }, 'optgroup_header': function (data, escape) { return '<div class="optgroup-header">' + escape(data[field_optgroup]) + '</div>' }, 'option': function (data, escape) { return '<div class="option">' + escape(data[field_label]) + '</div>' }, 'item': function (data, escape) { return '<div class="item">' + escape(data[field_label]) + '</div>' }, 'option_create': function (data, escape) { return '<div class="create">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>' } }; self.settings.render = $.extend({}, templates, self.settings.render) }, setupCallbacks: function () { var key, fn, callbacks = { 'initialize': 'onInitialize', 'change': 'onChange', 'item_add': 'onItemAdd', 'item_remove': 'onItemRemove', 'clear': 'onClear', 'option_add': 'onOptionAdd', 'option_remove': 'onOptionRemove', 'option_clear': 'onOptionClear', 'dropdown_open': 'onDropdownOpen', 'dropdown_close': 'onDropdownClose', 'type': 'onType' }; for (key in callbacks) { if (callbacks.hasOwnProperty(key)) { fn = this.settings[callbacks[key]]; if (fn) this.on(key, fn) } } }, onClick: function (e) { var self = this; if (!self.isFocused) { self.focus(); e.preventDefault() } }, onMouseDown: function (e) { var self = this; var defaultPrevented = e.isDefaultPrevented(); var $target = $(e.target); if (self.isFocused) { if (e.target !== self.$control_input[0]) { if (self.settings.mode === 'single') { self.isOpen ? self.close() : self.open() } else if (!defaultPrevented) { self.setActiveItem(null) } return false } } else { if (!defaultPrevented) { window.setTimeout(function () { self.focus() }, 0) } } }, onChange: function () { this.$input.trigger('change') }, onKeyPress: function (e) { if (this.isLocked) return e && e.preventDefault(); var character = String.fromCharCode(e.keyCode || e.which); if (this.settings.create && character === this.settings.delimiter) { this.createItem(); e.preventDefault(); return false } }, onKeyDown: function (e) { var isInput = e.target === this.$control_input[0]; var self = this; if (self.isLocked) { if (e.keyCode !== KEY_TAB) { e.preventDefault() } return } switch (e.keyCode) { case KEY_A: if (self.isCmdDown) { self.selectAll(); return } break; case KEY_ESC: self.close(); return; case KEY_DOWN: if (!self.isOpen && self.hasOptions) { self.open() } else if (self.$activeOption) { self.ignoreHover = true; var $next = self.getAdjacentOption(self.$activeOption, 1); if ($next.length) self.setActiveOption($next, true, true) } e.preventDefault(); return; case KEY_UP: if (self.$activeOption) { self.ignoreHover = true; var $prev = self.getAdjacentOption(self.$activeOption, -1); if ($prev.length) self.setActiveOption($prev, true, true) } e.preventDefault(); return; case KEY_RETURN: if (self.isOpen && self.$activeOption) { self.onOptionSelect({ currentTarget: self.$activeOption }) } e.preventDefault(); return; case KEY_LEFT: self.advanceSelection(-1, e); return; case KEY_RIGHT: self.advanceSelection(1, e); return; case KEY_TAB: if (self.settings.create && self.createItem()) { e.preventDefault() } return; case KEY_BACKSPACE: case KEY_DELETE: self.deleteSelection(e); return } if (self.isFull() || self.isInputHidden) { e.preventDefault(); return } }, onKeyUp: function (e) { var self = this; if (self.isLocked) return e && e.preventDefault(); var value = self.$control_input.val() || ''; if (self.lastValue !== value) { self.lastValue = value; self.onSearchChange(value); self.refreshOptions(); self.trigger('type', value) } }, onSearchChange: function (value) { var self = this; var fn = self.settings.load; if (!fn) return; if (self.loadedSearches.hasOwnProperty(value)) return; self.loadedSearches[value] = true; self.load(function (callback) { fn.apply(self, [value, callback]) }) }, onFocus: function (e) { var self = this; self.isFocused = true; if (self.isDisabled) { self.blur(); e && e.preventDefault(); return false } if (self.ignoreFocus) return; if (self.settings.preload === 'focus') self.onSearchChange(''); if (!self.$activeItems.length) { self.showInput(); self.setActiveItem(null); self.refreshOptions(!!self.settings.openOnFocus) } self.refreshState() }, onBlur: function (e) { var self = this; self.isFocused = false; if (self.ignoreFocus) return; if (self.settings.create && self.settings.createOnBlur) { self.createItem() } self.close(); self.setTextboxValue(''); self.setActiveItem(null); self.setActiveOption(null); self.setCaret(self.items.length); self.refreshState() }, onOptionHover: function (e) { if (this.ignoreHover) return; this.setActiveOption(e.currentTarget, false) }, onOptionSelect: function (e) { var value, $target, $option, self = this; if (e.preventDefault) { e.preventDefault(); e.stopPropagation() } $target = $(e.currentTarget); if ($target.hasClass('create')) { self.createItem() } else { value = $target.attr('data-value'); if (value) { self.lastQuery = null; self.setTextboxValue(''); self.addItem(value); if (!self.settings.hideSelected && e.type && /mouse/.test(e.type)) { self.setActiveOption(self.getOption(value)) } } } }, onItemSelect: function (e) { var self = this; if (self.isLocked) return; if (self.settings.mode === 'multi') { e.preventDefault(); self.setActiveItem(e.currentTarget, e) } }, load: function (fn) { var self = this; var $wrapper = self.$wrapper.addClass('loading'); self.loading++; fn.apply(self, [function (results) { self.loading = Math.max(self.loading - 1, 0); if (results && results.length) { self.addOption(results); self.refreshOptions(self.isFocused && !self.isInputHidden) } if (!self.loading) { $wrapper.removeClass('loading') } self.trigger('load', results) }]) }, setTextboxValue: function (value) { this.$control_input.val(value).triggerHandler('update'); this.lastValue = value }, getValue: function () { if (this.tagType === TAG_SELECT && this.$input.attr('multiple')) { return this.items } else { return this.items.join(this.settings.delimiter) } }, setValue: function (value) { debounce_events(this, ['change'], function () { this.clear(); var items = $.isArray(value) ? value : [value]; for (var i = 0, n = items.length; i < n; i++) { this.addItem(items[i]) } }) }, setActiveItem: function ($item, e) { var self = this; var eventName; var i, idx, begin, end, item, swap; var $last; if (self.settings.mode === 'single') return; $item = $($item); if (!$item.length) { $(self.$activeItems).removeClass('active'); self.$activeItems = []; if (self.isFocused) { self.showInput() } return } eventName = e && e.type.toLowerCase(); if (eventName === 'mousedown' && self.isShiftDown && self.$activeItems.length) { $last = self.$control.children('.active:last'); begin = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$last[0]]); end = Array.prototype.indexOf.apply(self.$control[0].childNodes, [$item[0]]); if (begin > end) { swap = begin; begin = end; end = swap } for (i = begin; i <= end; i++) { item = self.$control[0].childNodes[i]; if (self.$activeItems.indexOf(item) === -1) { $(item).addClass('active'); self.$activeItems.push(item) } } e.preventDefault() } else if ((eventName === 'mousedown' && self.isCtrlDown) || (eventName === 'keydown' && this.isShiftDown)) { if ($item.hasClass('active')) { idx = self.$activeItems.indexOf($item[0]); self.$activeItems.splice(idx, 1); $item.removeClass('active') } else { self.$activeItems.push($item.addClass('active')[0]) } } else { $(self.$activeItems).removeClass('active'); self.$activeItems = [$item.addClass('active')[0]] } self.hideInput(); if (!this.isFocused) { self.focus() } }, setActiveOption: function ($option, scroll, animate) { var height_menu, height_item, y; var scroll_top, scroll_bottom; var self = this; if (self.$activeOption) self.$activeOption.removeClass('active'); self.$activeOption = null; $option = $($option); if (!$option.length) return; self.$activeOption = $option.addClass('active'); if (scroll || !isset(scroll)) { height_menu = self.$dropdown_content.height(); height_item = self.$activeOption.outerHeight(true); scroll = self.$dropdown_content.scrollTop() || 0; y = self.$activeOption.offset().top - self.$dropdown_content.offset().top + scroll; scroll_top = y; scroll_bottom = y - height_menu + height_item; if (y + height_item > height_menu + scroll) { self.$dropdown_content.stop().animate({ scrollTop: scroll_bottom }, animate ? self.settings.scrollDuration : 0) } else if (y < scroll) { self.$dropdown_content.stop().animate({ scrollTop: scroll_top }, animate ? self.settings.scrollDuration : 0) } } }, selectAll: function () { var self = this; if (self.settings.mode === 'single') return; self.$activeItems = Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active')); if (self.$activeItems.length) { self.hideInput(); self.close() } self.focus() }, hideInput: function () { var self = this; self.setTextboxValue(''); self.$control_input.css({ opacity: 0, position: 'absolute', left: self.rtl ? 10000 : -10000 }); self.isInputHidden = true }, showInput: function () { this.$control_input.css({ opacity: 1, position: 'relative', left: 0 }); this.isInputHidden = false }, focus: function () { var self = this; if (self.isDisabled) return; self.ignoreFocus = true; self.$control_input[0].focus(); window.setTimeout(function () { self.ignoreFocus = false; self.onFocus() }, 0) }, blur: function () { this.$control_input.trigger('blur') }, getScoreFunction: function (query) { return this.sifter.getScoreFunction(query, this.getSearchOptions()) }, getSearchOptions: function () { var settings = this.settings; var sort = settings.sortField; if (typeof sort === 'string') { sort = { field: sort } } return { fields: settings.searchField, conjunction: settings.searchConjunction, sort: sort } }, search: function (query) { var i, value, score, result, calculateScore; var self = this; var settings = self.settings; var options = this.getSearchOptions(); if (settings.score) { calculateScore = self.settings.score.apply(this, [query]); if (typeof calculateScore !== 'function') { throw new Error('Selectize "score" setting must be a function that returns a function'); } } if (query !== self.lastQuery) { self.lastQuery = query; result = self.sifter.search(query, $.extend(options, { score: calculateScore })); self.currentResults = result } else { result = $.extend(true, {}, self.currentResults) } if (settings.hideSelected) { for (i = result.items.length - 1; i >= 0; i--) { if (self.items.indexOf(hash_key(result.items[i].id)) !== -1) { result.items.splice(i, 1) } } } return result }, refreshOptions: function (triggerDropdown) { var i, j, k, n, groups, groups_order, option, option_html, optgroup, optgroups, html, html_children, has_create_option; var $active, $active_before, $create; if (typeof triggerDropdown === 'undefined') { triggerDropdown = true } var self = this; var query = self.$control_input.val(); var results = self.search(query); var $dropdown_content = self.$dropdown_content; var active_before = self.$activeOption && hash_key(self.$activeOption.attr('data-value')); n = results.items.length; if (typeof self.settings.maxOptions === 'number') { n = Math.min(n, self.settings.maxOptions) } groups = {}; if (self.settings.optgroupOrder) { groups_order = self.settings.optgroupOrder; for (i = 0; i < groups_order.length; i++) { groups[groups_order[i]] = [] } } else { groups_order = [] } for (i = 0; i < n; i++) { option = self.options[results.items[i].id]; option_html = self.render('option', option); optgroup = option[self.settings.optgroupField] || ''; optgroups = $.isArray(optgroup) ? optgroup : [optgroup]; for (j = 0, k = optgroups && optgroups.length; j < k; j++) { optgroup = optgroups[j]; if (!self.optgroups.hasOwnProperty(optgroup)) { optgroup = '' } if (!groups.hasOwnProperty(optgroup)) { groups[optgroup] = []; groups_order.push(optgroup) } groups[optgroup].push(option_html) } } html = []; for (i = 0, n = groups_order.length; i < n; i++) { optgroup = groups_order[i]; if (self.optgroups.hasOwnProperty(optgroup) && groups[optgroup].length) { html_children = self.render('optgroup_header', self.optgroups[optgroup]) || ''; html_children += groups[optgroup].join(''); html.push(self.render('optgroup', $.extend({}, self.optgroups[optgroup], { html: html_children }))) } else { html.push(groups[optgroup].join('')) } } $dropdown_content.html(html.join('')); if (self.settings.highlight && results.query.length && results.tokens.length) { for (i = 0, n = results.tokens.length; i < n; i++) { highlight($dropdown_content, results.tokens[i].regex) } } if (!self.settings.hideSelected) { for (i = 0, n = self.items.length; i < n; i++) { self.getOption(self.items[i]).addClass('selected') } } has_create_option = self.settings.create && results.query.length; if (has_create_option) { $dropdown_content.prepend(self.render('option_create', { input: query })); $create = $($dropdown_content[0].childNodes[0]) } self.hasOptions = results.items.length > 0 || has_create_option; if (self.hasOptions) { if (results.items.length > 0) { $active_before = active_before && self.getOption(active_before); if ($active_before && $active_before.length) { $active = $active_before } else if (self.settings.mode === 'single' && self.items.length) { $active = self.getOption(self.items[0]) } if (!$active || !$active.length) { if ($create && !self.settings.addPrecedence) { $active = self.getAdjacentOption($create, 1) } else { $active = $dropdown_content.find('[data-selectable]:first') } } } else { $active = $create } self.setActiveOption($active); if (triggerDropdown && !self.isOpen) { self.open() } } else { self.setActiveOption(null); if (triggerDropdown && self.isOpen) { self.close() } } }, addOption: function (data) { var i, n, optgroup, value, self = this; if ($.isArray(data)) { for (i = 0, n = data.length; i < n; i++) { self.addOption(data[i]) } return } value = hash_key(data[self.settings.valueField]); if (!value || self.options.hasOwnProperty(value)) return; self.userOptions[value] = true; self.options[value] = data; self.lastQuery = null; self.trigger('option_add', value, data) }, addOptionGroup: function (id, data) { this.optgroups[id] = data; this.trigger('optgroup_add', id, data) }, updateOption: function (value, data) { var self = this; var $item, $item_new; var value_new, index_item, cache_items, cache_options; value = hash_key(value); value_new = hash_key(data[self.settings.valueField]); if (!self.options.hasOwnProperty(value)) return; if (!value_new) throw new Error('Value must be set in option data'); if (value_new !== value) { delete self.options[value]; index_item = self.items.indexOf(value); if (index_item !== -1) { self.items.splice(index_item, 1, value_new) } } self.options[value_new] = data; cache_items = self.renderCache['item']; cache_options = self.renderCache['option']; if (isset(cache_items)) { delete cache_items[value]; delete cache_items[value_new] } if (isset(cache_options)) { delete cache_options[value]; delete cache_options[value_new] } if (self.items.indexOf(value_new) !== -1) { $item = self.getItem(value); $item_new = $(self.render('item', data)); if ($item.hasClass('active')) $item_new.addClass('active'); $item.replaceWith($item_new) } if (self.isOpen) { self.refreshOptions(false) } }, removeOption: function (value) { var self = this; value = hash_key(value); delete self.userOptions[value]; delete self.options[value]; self.lastQuery = null; self.trigger('option_remove', value); self.removeItem(value) }, clearOptions: function () { var self = this; self.loadedSearches = {}; self.userOptions = {}; self.options = self.sifter.items = {}; self.lastQuery = null; self.trigger('option_clear'); self.clear() }, getOption: function (value) { return this.getElementWithValue(value, this.$dropdown_content.find('[data-selectable]')) }, getAdjacentOption: function ($option, direction) { var $options = this.$dropdown.find('[data-selectable]'); var index = $options.index($option) + direction; return index >= 0 && index < $options.length ? $options.eq(index) : $() }, getElementWithValue: function (value, $els) { value = hash_key(value); if (value) { for (var i = 0, n = $els.length; i < n; i++) { if ($els[i].getAttribute('data-value') === value) { return $($els[i]) } } } return $() }, getItem: function (value) { return this.getElementWithValue(value, this.$control.children()) }, addItem: function (value) { debounce_events(this, ['change'], function () { var $item, $option; var self = this; var inputMode = self.settings.mode; var i, active, options, value_next; value = hash_key(value); if (self.items.indexOf(value) !== -1) { if (inputMode === 'single') self.close(); return } if (!self.options.hasOwnProperty(value)) return; if (inputMode === 'single') self.clear(); if (inputMode === 'multi' && self.isFull()) return; $item = $(self.render('item', self.options[value])); self.items.splice(self.caretPos, 0, value); self.insertAtCaret($item); self.refreshState(); if (self.isSetup) { options = self.$dropdown_content.find('[data-selectable]'); $option = self.getOption(value); value_next = self.getAdjacentOption($option, 1).attr('data-value'); self.refreshOptions(self.isFocused && inputMode !== 'single'); if (value_next) { self.setActiveOption(self.getOption(value_next)) } if (!options.length || (self.settings.maxItems !== null && self.items.length >= self.settings.maxItems)) { self.close() } else { self.positionDropdown() } self.updatePlaceholder(); self.trigger('item_add', value, $item); self.updateOriginalInput() } }) }, removeItem: function (value) { var self = this; var $item, i, idx; $item = (typeof value === 'object') ? value : self.getItem(value); value = hash_key($item.attr('data-value')); i = self.items.indexOf(value); if (i !== -1) { $item.remove(); if ($item.hasClass('active')) { idx = self.$activeItems.indexOf($item[0]); self.$activeItems.splice(idx, 1) } self.items.splice(i, 1); self.lastQuery = null; if (!self.settings.persist && self.userOptions.hasOwnProperty(value)) { self.removeOption(value) } if (i < self.caretPos) { self.setCaret(self.caretPos - 1) } self.refreshState(); self.updatePlaceholder(); self.updateOriginalInput(); self.positionDropdown(); self.trigger('item_remove', value) } }, createItem: function () { var self = this; var input = $.trim(self.$control_input.val() || ''); var caret = self.caretPos; if (!input.length) return false; self.lock(); var setup = (typeof self.settings.create === 'function') ? this.settings.create : function (input) { var data = {}; data[self.settings.labelField] = input; data[self.settings.valueField] = input; return data }; var create = once(function (data) { self.unlock(); if (!data || typeof data !== 'object') return; var value = hash_key(data[self.settings.valueField]); if (!value) return; self.setTextboxValue(''); self.addOption(data); self.setCaret(caret); self.addItem(value); self.refreshOptions(self.settings.mode !== 'single') }); var output = setup.apply(this, [input, create]); if (typeof output !== 'undefined') { create(output) } return true }, refreshItems: function () { this.lastQuery = null; if (this.isSetup) { for (var i = 0; i < this.items.length; i++) { this.addItem(this.items) } } this.refreshState(); this.updateOriginalInput() }, refreshState: function () { var self = this; var invalid = self.isRequired && !self.items.length; if (!invalid) self.isInvalid = false; self.$control_input.prop('required', invalid); self.refreshClasses() }, refreshClasses: function () { var self = this; var isFull = self.isFull(); var isLocked = self.isLocked; self.$wrapper.toggleClass('rtl', self.rtl); self.$control.toggleClass('focus', self.isFocused).toggleClass('disabled', self.isDisabled).toggleClass('required', self.isRequired).toggleClass('invalid', self.isInvalid).toggleClass('locked', isLocked).toggleClass('full', isFull).toggleClass('not-full', !isFull).toggleClass('input-active', self.isFocused && !self.isInputHidden).toggleClass('dropdown-active', self.isOpen).toggleClass('has-options', !$.isEmptyObject(self.options)).toggleClass('has-items', self.items.length > 0); self.$control_input.data('grow', !isFull && !isLocked) }, isFull: function () { return this.settings.maxItems !== null && this.items.length >= this.settings.maxItems }, updateOriginalInput: function () { var i, n, options, self = this; if (self.$input[0].tagName.toLowerCase() === 'select') { options = []; for (i = 0, n = self.items.length; i < n; i++) { options.push('<option value="' + escape_html(self.items[i]) + '" selected="selected"></option>') } if (!options.length && !this.$input.attr('multiple')) { options.push('<option value="" selected="selected"></option>') } self.$input.html(options.join('')) } else { self.$input.val(self.getValue()) } if (self.isSetup) { self.trigger('change', self.$input.val()) } }, updatePlaceholder: function () { if (!this.settings.placeholder) return; var $input = this.$control_input; if (this.items.length) { $input.removeAttr('placeholder') } else { $input.attr('placeholder', this.settings.placeholder) } $input.triggerHandler('update') }, open: function () { var self = this; if (self.isLocked || self.isOpen || (self.settings.mode === 'multi' && self.isFull())) return; self.focus(); self.isOpen = true; self.refreshState(); self.$dropdown.css({ visibility: 'hidden', display: 'block' }); self.positionDropdown(); self.$dropdown.css({ visibility: 'visible' }); self.trigger('dropdown_open', self.$dropdown) }, close: function () { var self = this; var trigger = self.isOpen; if (self.settings.mode === 'single' && self.items.length) { self.hideInput() } self.isOpen = false; self.$dropdown.hide(); self.setActiveOption(null); self.refreshState(); if (trigger) self.trigger('dropdown_close', self.$dropdown) }, positionDropdown: function () { var $control = this.$control; var offset = this.settings.dropdownParent === 'body' ? $control.offset() : $control.position(); offset.top += $control.outerHeight(true); this.$dropdown.css({ width: $control.outerWidth(), top: offset.top, left: offset.left }) }, clear: function () { var self = this; if (!self.items.length) return; self.$control.children(':not(input)').remove(); self.items = []; self.setCaret(0); self.updatePlaceholder(); self.updateOriginalInput(); self.refreshState(); self.showInput(); self.trigger('clear') }, insertAtCaret: function ($el) { var caret = Math.min(this.caretPos, this.items.length); if (caret === 0) { this.$control.prepend($el) } else { $(this.$control[0].childNodes[caret]).before($el) } this.setCaret(caret + 1) }, deleteSelection: function (e) { var i, n, direction, selection, values, caret, option_select, $option_select, $tail; var self = this; direction = (e && e.keyCode === KEY_BACKSPACE) ? -1 : 1; selection = getSelection(self.$control_input[0]); if (self.$activeOption && !self.settings.hideSelected) { option_select = self.getAdjacentOption(self.$activeOption, -1).attr('data-value') } values = []; if (self.$activeItems.length) { $tail = self.$control.children('.active:' + (direction > 0 ? 'last' : 'first')); caret = self.$control.children(':not(input)').index($tail); if (direction > 0) { caret++ } for (i = 0, n = self.$activeItems.length; i < n; i++) { values.push($(self.$activeItems[i]).attr('data-value')) } if (e) { e.preventDefault(); e.stopPropagation() } } else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) { if (direction < 0 && selection.start === 0 && selection.length === 0) { values.push(self.items[self.caretPos - 1]) } else if (direction > 0 && selection.start === self.$control_input.val().length) { values.push(self.items[self.caretPos]) } } if (!values.length || (typeof self.settings.onDelete === 'function' && self.settings.onDelete.apply(self, [values]) === false)) { return false } if (typeof caret !== 'undefined') { self.setCaret(caret) } while (values.length) { self.removeItem(values.pop()) } self.showInput(); self.positionDropdown(); self.refreshOptions(true); if (option_select) { $option_select = self.getOption(option_select); if ($option_select.length) { self.setActiveOption($option_select) } } return true }, advanceSelection: function (direction, e) { var tail, selection, idx, valueLength, cursorAtEdge, $tail; var self = this; if (direction === 0) return; if (self.rtl) direction *= -1; tail = direction > 0 ? 'last' : 'first'; selection = getSelection(self.$control_input[0]); if (self.isFocused && !self.isInputHidden) { valueLength = self.$control_input.val().length; cursorAtEdge = direction < 0 ? selection.start === 0 && selection.length === 0 : selection.start === valueLength; if (cursorAtEdge && !valueLength) { self.advanceCaret(direction, e) } } else { $tail = self.$control.children('.active:' + tail); if ($tail.length) { idx = self.$control.children(':not(input)').index($tail); self.setActiveItem(null); self.setCaret(direction > 0 ? idx + 1 : idx) } } }, advanceCaret: function (direction, e) { var self = this, fn, $adj; if (direction === 0) return; fn = direction > 0 ? 'next' : 'prev'; if (self.isShiftDown) { $adj = self.$control_input[fn](); if ($adj.length) { self.hideInput(); self.setActiveItem($adj); e && e.preventDefault() } } else { self.setCaret(self.caretPos + direction) } }, setCaret: function (i) { var self = this; if (self.settings.mode === 'single') { i = self.items.length } else { i = Math.max(0, Math.min(self.items.length, i)) } var j, n, fn, $children, $child; $children = self.$control.children(':not(input)'); for (j = 0, n = $children.length; j < n; j++) { $child = $($children[j]).detach(); if (j < i) { self.$control_input.before($child) } else { self.$control.append($child) } } self.caretPos = i }, lock: function () { this.close(); this.isLocked = true; this.refreshState() }, unlock: function () { this.isLocked = false; this.refreshState() }, disable: function () { var self = this; self.$input.prop('disabled', true); self.isDisabled = true; self.lock() }, enable: function () { var self = this; self.$input.prop('disabled', false); self.isDisabled = false; self.unlock() }, destroy: function () { var self = this; var eventNS = self.eventNS; var revertSettings = self.revertSettings; self.trigger('destroy'); self.off(); self.$wrapper.remove(); self.$dropdown.remove(); self.$input.html('').append(revertSettings.$children).removeAttr('tabindex').attr({ tabindex: revertSettings.tabindex }).show(); $(window).off(eventNS); $(document).off(eventNS); $(document.body).off(eventNS); delete self.$input[0].selectize }, render: function (templateName, data) { var value, id, label; var html = ''; var cache = false; var self = this; var regex_tag = /^[\t ]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i; if (templateName === 'option' || templateName === 'item') { value = hash_key(data[self.settings.valueField]); cache = !!value } if (cache) { if (!isset(self.renderCache[templateName])) { self.renderCache[templateName] = {} } if (self.renderCache[templateName].hasOwnProperty(value)) { return self.renderCache[templateName][value] } } html = self.settings.render[templateName].apply(this, [data, escape_html]); if (templateName === 'option' || templateName === 'option_create') { html = html.replace(regex_tag, '<$1 data-selectable') } if (templateName === 'optgroup') { id = data[self.settings.optgroupValueField] || ''; html = html.replace(regex_tag, '<$1 data-group="' + escape_replace(escape_html(id)) + '"') } if (templateName === 'option' || templateName === 'item') { html = html.replace(regex_tag, '<$1 data-value="' + escape_replace(escape_html(value || '')) + '"') } if (cache) { self.renderCache[templateName][value] = html } return html } }); Selectize.count = 0; Selectize.defaults = { plugins: [], delimiter: ',', persist: true, diacritics: true, create: false, createOnBlur: false, highlight: true, openOnFocus: true, maxOptions: 1000, maxItems: null, hideSelected: null, addPrecedence: false, preload: false, scrollDuration: 60, loadThrottle: 300, dataAttr: 'data-data', optgroupField: 'optgroup', valueField: 'value', labelField: 'text', optgroupLabelField: 'label', optgroupValueField: 'value', optgroupOrder: null, sortField: '$order', searchField: ['text'], searchConjunction: 'and', mode: null, wrapperClass: 'selectize-control', inputClass: 'selectize-input', dropdownClass: 'selectize-dropdown', dropdownContentClass: 'selectize-dropdown-content', dropdownParent: null, render: {} }; $.fn.selectize = function (settings_user) { var defaults = $.fn.selectize.defaults; var settings = $.extend({}, defaults, settings_user); var attr_data = settings.dataAttr; var field_label = settings.labelField; var field_value = settings.valueField; var field_optgroup = settings.optgroupField; var field_optgroup_label = settings.optgroupLabelField; var field_optgroup_value = settings.optgroupValueField; var init_textbox = function ($input, settings_element) { var i, n, values, option, value = $.trim($input.val() || ''); if (!value.length) return; values = value.split(settings.delimiter); for (i = 0, n = values.length; i < n; i++) { option = {}; option[field_label] = values[i]; option[field_value] = values[i]; settings_element.options[values[i]] = option } settings_element.items = values }; var init_select = function ($input, settings_element) { var i, n, tagName, $children, order = 0; var options = settings_element.options; var readData = function ($el) { var data = attr_data && $el.attr(attr_data); if (typeof data === 'string' && data.length) { return JSON.parse(data) } return null }; var addOption = function ($option, group) { var value, option; $option = $($option); value = $option.attr('value') || ''; if (!value.length) return; if (options.hasOwnProperty(value)) { if (group) { if (!options[value].optgroup) { options[value].optgroup = group } else if (!$.isArray(options[value].optgroup)) { options[value].optgroup = [options[value].optgroup, group] } else { options[value].optgroup.push(group) } } return } option = readData($option) || {}; option[field_label] = option[field_label] || $option.text(); option[field_value] = option[field_value] || value; option[field_optgroup] = option[field_optgroup] || group; option.$order = ++order; options[value] = option; if ($option.is(':selected')) { settings_element.items.push(value) } }; var addGroup = function ($optgroup) { var i, n, id, optgroup, $options; $optgroup = $($optgroup); id = $optgroup.attr('label'); if (id) { optgroup = readData($optgroup) || {}; optgroup[field_optgroup_label] = id; optgroup[field_optgroup_value] = id; settings_element.optgroups[id] = optgroup } $options = $('option', $optgroup); for (i = 0, n = $options.length; i < n; i++) { addOption($options[i], id) } }; settings_element.maxItems = $input.attr('multiple') ? null : 1; $children = $input.children(); for (i = 0, n = $children.length; i < n; i++) { tagName = $children[i].tagName.toLowerCase(); if (tagName === 'optgroup') { addGroup($children[i]) } else if (tagName === 'option') { addOption($children[i]) } } }; return this.each(function () { if (this.selectize) return; var instance; var $input = $(this); var tag_name = this.tagName.toLowerCase(); var settings_element = { 'placeholder': $input.children('option[value=""]').text() || $input.attr('placeholder'), 'options': {}, 'optgroups': {}, 'items': [] }; if (tag_name === 'select') { init_select($input, settings_element) } else { init_textbox($input, settings_element) } instance = new Selectize($input, $.extend(true, {}, defaults, settings_element, settings_user)); $input.data('selectize', instance); $input.addClass('selectized') }) }; $.fn.selectize.defaults = Selectize.defaults; Selectize.define('drag_drop', function (options) { if (!$.fn.sortable) throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".'); if (this.settings.mode !== 'multi') return; var self = this; self.lock = (function () { var original = self.lock; return function () { var sortable = self.$control.data('sortable'); if (sortable) sortable.disable(); return original.apply(self, arguments) } })(); self.unlock = (function () { var original = self.unlock; return function () { var sortable = self.$control.data('sortable'); if (sortable) sortable.enable(); return original.apply(self, arguments) } })(); self.setup = (function () { var original = self.setup; return function () { original.apply(this, arguments); var $control = self.$control.sortable({ items: '[data-value]', forcePlaceholderSize: true, disabled: self.isLocked, start: function (e, ui) { ui.placeholder.css('width', ui.helper.css('width')); $control.css({ overflow: 'visible' }) }, stop: function () { $control.css({ overflow: 'hidden' }); var active = self.$activeItems ? self.$activeItems.slice() : null; var values = []; $control.children('[data-value]').each(function () { values.push($(this).attr('data-value')) }); self.setValue(values); self.setActiveItem(active) } }) } })() }); Selectize.define('dropdown_header', function (options) { var self = this; options = $.extend({ title: 'Untitled', headerClass: 'selectize-dropdown-header', titleRowClass: 'selectize-dropdown-header-title', labelClass: 'selectize-dropdown-header-label', closeClass: 'selectize-dropdown-header-close', html: function (data) { return ('<div class="' + data.headerClass + '">' + '<div class="' + data.titleRowClass + '">' + '<span class="' + data.labelClass + '">' + data.title + '</span>' + '<a href="javascript:void(0)" class="' + data.closeClass + '">&times;</a>' + '</div>' + '</div>') } }, options); self.setup = (function () { var original = self.setup; return function () { original.apply(self, arguments); self.$dropdown_header = $(options.html(options)); self.$dropdown.prepend(self.$dropdown_header) } })() }); Selectize.define('optgroup_columns', function (options) { var self = this; options = $.extend({ equalizeWidth: true, equalizeHeight: true }, options); this.getAdjacentOption = function ($option, direction) { var $options = $option.closest('[data-group]').find('[data-selectable]'); var index = $options.index($option) + direction; return index >= 0 && index < $options.length ? $options.eq(index) : $() }; this.onKeyDown = (function () { var original = self.onKeyDown; return function (e) { var index, $option, $options, $optgroup; if (this.isOpen && (e.keyCode === KEY_LEFT || e.keyCode === KEY_RIGHT)) { self.ignoreHover = true; $optgroup = this.$activeOption.closest('[data-group]'); index = $optgroup.find('[data-selectable]').index(this.$activeOption); if (e.keyCode === KEY_LEFT) { $optgroup = $optgroup.prev('[data-group]') } else { $optgroup = $optgroup.next('[data-group]') } $options = $optgroup.find('[data-selectable]'); $option = $options.eq(Math.min($options.length - 1, index)); if ($option.length) { this.setActiveOption($option) } return } return original.apply(this, arguments) } })(); var equalizeSizes = function () { var i, n, height_max, width, width_last, width_parent, $optgroups; $optgroups = $('[data-group]', self.$dropdown_content); n = $optgroups.length; if (!n || !self.$dropdown_content.width()) return; if (options.equalizeHeight) { height_max = 0; for (i = 0; i < n; i++) { height_max = Math.max(height_max, $optgroups.eq(i).height()) } $optgroups.css({ height: height_max }) } if (options.equalizeWidth) { width_parent = self.$dropdown_content.innerWidth(); width = Math.round(width_parent / n); $optgroups.css({ width: width }); if (n > 1) { width_last = width_parent - width * (n - 1); $optgroups.eq(n - 1).css({ width: width_last }) } } }; if (options.equalizeHeight || options.equalizeWidth) { hook.after(this, 'positionDropdown', equalizeSizes); hook.after(this, 'refreshOptions', equalizeSizes) } }); Selectize.define('remove_button', function (options) { if (this.settings.mode === 'single') return; options = $.extend({ label: '&times;', title: 'Remove', className: 'remove', append: true }, options); var self = this; var html = '<a href="javascript:void(0)" class="' + options.className + '" tabindex="-1" title="' + escape_html(options.title) + '">' + options.label + '</a>'; var append = function (html_container, html_element) { var pos = html_container.search(/(<\/[^>]+>\s*)$/); return html_container.substring(0, pos) + html_element + html_container.substring(pos) }; this.setup = (function () { var original = self.setup; return function () { if (options.append) { var render_item = self.settings.render.item; self.settings.render.item = function (data) { return append(render_item.apply(this, arguments), html) } } original.apply(this, arguments); this.$control.on('click', '.' + options.className, function (e) { e.preventDefault(); if (self.isLocked) return; var $item = $(e.target).parent(); self.setActiveItem($item); if (self.deleteSelection()) { self.setCaret(self.items.length) } }) } })() }); Selectize.define('restore_on_backspace', function (options) { var self = this; options.text = options.text || function (option) { return option[this.settings.labelField] }; this.onKeyDown = (function (e) { var original = self.onKeyDown; return function (e) { var index, option; if (e.keyCode === KEY_BACKSPACE && this.$control_input.val() === '' && !this.$activeItems.length) { index = this.caretPos - 1; if (index >= 0 && index < this.items.length) { option = this.options[this.items[index]]; if (this.deleteSelection(e)) { this.setTextboxValue(options.text.apply(this, [option])); this.refreshOptions(true) } e.preventDefault(); return } } return original.apply(this, arguments) } })() }); return Selectize }));

/*Form Uniform*/
; (function (e, t) { "use strict"; function n(e) { var t = Array.prototype.slice.call(arguments, 1); return e.prop ? e.prop.apply(e, t) : e.attr.apply(e, t) } function s(e, t, n) { var s, a; for (s in n) n.hasOwnProperty(s) && (a = s.replace(/ |$/g, t.eventNamespace), e.bind(a, n[s])) } function a(e, t, n) { s(e, n, { focus: function () { t.addClass(n.focusClass) }, blur: function () { t.removeClass(n.focusClass), t.removeClass(n.activeClass) }, mouseenter: function () { t.addClass(n.hoverClass) }, mouseleave: function () { t.removeClass(n.hoverClass), t.removeClass(n.activeClass) }, "mousedown touchbegin": function () { e.is(":disabled") || t.addClass(n.activeClass) }, "mouseup touchend": function () { t.removeClass(n.activeClass) } }) } function i(e, t) { e.removeClass(t.hoverClass + " " + t.focusClass + " " + t.activeClass) } function r(e, t, n) { n ? e.addClass(t) : e.removeClass(t) } function l(e, t, n) { var s = "checked", a = t.is(":" + s); t.prop ? t.prop(s, a) : a ? t.attr(s, s) : t.removeAttr(s), r(e, n.checkedClass, a) } function u(e, t, n) { r(e, n.disabledClass, t.is(":disabled")) } function o(e, t, n) { switch (n) { case "after": return e.after(t), e.next(); case "before": return e.before(t), e.prev(); case "wrap": return e.wrap(t), e.parent() } return null } function c(t, s, a) { var i, r, l; return a || (a = {}), a = e.extend({ bind: {}, divClass: null, divWrap: "wrap", spanClass: null, spanHtml: null, spanWrap: "wrap" }, a), i = e("<div />"), r = e("<span />"), s.autoHide && t.is(":hidden") && "none" === t.css("display") && i.hide(), a.divClass && i.addClass(a.divClass), s.wrapperClass && i.addClass(s.wrapperClass), a.spanClass && r.addClass(a.spanClass), l = n(t, "id"), s.useID && l && n(i, "id", s.idPrefix + "-" + l), a.spanHtml && r.html(a.spanHtml), i = o(t, i, a.divWrap), r = o(t, r, a.spanWrap), u(i, t, s), { div: i, span: r } } function d(t, n) { var s; return n.wrapperClass ? (s = e("<span />").addClass(n.wrapperClass), s = o(t, s, "wrap")) : null } function f() { var t, n, s, a; return a = "rgb(120,2,153)", n = e('<div style="width:0;height:0;color:' + a + '">'), e("body").append(n), s = n.get(0), t = window.getComputedStyle ? window.getComputedStyle(s, "").color : (s.currentStyle || s.style || {}).color, n.remove(), t.replace(/ /g, "") !== a } function p(t) { return t ? e("<span />").text(t).html() : "" } function m() { return navigator.cpuClass && !navigator.product } function v() { return window.XMLHttpRequest !== void 0 ? !0 : !1 } function h(e) { var t; return e[0].multiple ? !0 : (t = n(e, "size"), !t || 1 >= t ? !1 : !0) } function C() { return !1 } function w(e, t) { var n = "none"; s(e, t, { "selectstart dragstart mousedown": C }), e.css({ MozUserSelect: n, msUserSelect: n, webkitUserSelect: n, userSelect: n }) } function b(e, t, n) { var s = e.val(); "" === s ? s = n.fileDefaultHtml : (s = s.split(/[\/\\]+/), s = s[s.length - 1]), t.text(s) } function y(e, t, n) { var s, a; for (s = [], e.each(function () { var e; for (e in t) Object.prototype.hasOwnProperty.call(t, e) && (s.push({ el: this, name: e, old: this.style[e] }), this.style[e] = t[e]) }), n() ; s.length;) a = s.pop(), a.el.style[a.name] = a.old } function g(e, t) { var n; n = e.parents(), n.push(e[0]), n = n.not(":visible"), y(n, { visibility: "hidden", display: "block", position: "absolute" }, t) } function k(e, t) { return function () { e.unwrap().unwrap().unbind(t.eventNamespace) } } var H = !0, x = !1, A = [{ match: function (e) { return e.is("a, button, :submit, :reset, input[type='button']") }, apply: function (e, t) { var r, l, o, d, f; return l = t.submitDefaultHtml, e.is(":reset") && (l = t.resetDefaultHtml), d = e.is("a, button") ? function () { return e.html() || l } : function () { return p(n(e, "value")) || l }, o = c(e, t, { divClass: t.buttonClass, spanHtml: d() }), r = o.div, a(e, r, t), f = !1, s(r, t, { "click touchend": function () { var t, s, a, i; f || e.is(":disabled") || (f = !0, e[0].dispatchEvent ? (t = document.createEvent("MouseEvents"), t.initEvent("click", !0, !0), s = e[0].dispatchEvent(t), e.is("a") && s && (a = n(e, "target"), i = n(e, "href"), a && "_self" !== a ? window.open(i, a) : document.location.href = i)) : e.click(), f = !1) } }), w(r, t), { remove: function () { return r.after(e), r.remove(), e.unbind(t.eventNamespace), e }, update: function () { i(r, t), u(r, e, t), e.detach(), o.span.html(d()).append(e) } } } }, { match: function (e) { return e.is(":checkbox") }, apply: function (e, t) { var n, r, o; return n = c(e, t, { divClass: t.checkboxClass }), r = n.div, o = n.span, a(e, r, t), s(e, t, { "click touchend": function () { l(o, e, t) } }), l(o, e, t), { remove: k(e, t), update: function () { i(r, t), o.removeClass(t.checkedClass), l(o, e, t), u(r, e, t) } } } }, { match: function (e) { return e.is(":file") }, apply: function (t, r) { function l() { b(t, p, r) } var d, f, p, v; return d = c(t, r, { divClass: r.fileClass, spanClass: r.fileButtonClass, spanHtml: r.fileButtonHtml, spanWrap: "after" }), f = d.div, v = d.span, p = e("<span />").html(r.fileDefaultHtml), p.addClass(r.filenameClass), p = o(t, p, "after"), n(t, "size") || n(t, "size", f.width() / 10), a(t, f, r), l(), m() ? s(t, r, { click: function () { t.trigger("change"), setTimeout(l, 0) } }) : s(t, r, { change: l }), w(p, r), w(v, r), { remove: function () { return p.remove(), v.remove(), t.unwrap().unbind(r.eventNamespace) }, update: function () { i(f, r), b(t, p, r), u(f, t, r) } } } }, { match: function (e) { if (e.is("input")) { var t = (" " + n(e, "type") + " ").toLowerCase(), s = " color date datetime datetime-local email month number password search tel text time url week "; return s.indexOf(t) >= 0 } return !1 }, apply: function (e, t) { var s, i; return s = n(e, "type"), e.addClass(t.inputClass), i = d(e, t), a(e, e, t), t.inputAddTypeAsClass && e.addClass(s), { remove: function () { e.removeClass(t.inputClass), t.inputAddTypeAsClass && e.removeClass(s), i && e.unwrap() }, update: C } } }, { match: function (e) { return e.is(":radio") }, apply: function (t, r) { var o, d, f; return o = c(t, r, { divClass: r.radioClass }), d = o.div, f = o.span, a(t, d, r), s(t, r, { "click touchend": function () { e.uniform.update(e(':radio[name="' + n(t, "name") + '"]')) } }), l(f, t, r), { remove: k(t, r), update: function () { i(d, r), l(f, t, r), u(d, t, r) } } } }, { match: function (e) { return e.is("select") && !h(e) ? !0 : !1 }, apply: function (t, n) { var r, l, o, d; return n.selectAutoWidth && g(t, function () { d = t.width() }), r = c(t, n, { divClass: n.selectClass, spanHtml: (t.find(":selected:first") || t.find("option:first")).html(), spanWrap: "before" }), l = r.div, o = r.span, n.selectAutoWidth ? g(t, function () { y(e([o[0], l[0]]), { display: "block" }, function () { var e; e = o.outerWidth() - o.width(), l.width(d + e), o.width(d) }) }) : l.addClass("fixedWidth"), a(t, l, n), s(t, n, { change: function () { o.html(t.find(":selected").html()), l.removeClass(n.activeClass) }, "click touchend": function () { var e = t.find(":selected").html(); o.html() !== e && t.trigger("change") }, keyup: function () { o.html(t.find(":selected").html()) } }), w(o, n), { remove: function () { return o.remove(), t.unwrap().unbind(n.eventNamespace), t }, update: function () { n.selectAutoWidth ? (e.uniform.restore(t), t.uniform(n)) : (i(l, n), o.html(t.find(":selected").html()), u(l, t, n)) } } } }, { match: function (e) { return e.is("select") && h(e) ? !0 : !1 }, apply: function (e, t) { var n; return e.addClass(t.selectMultiClass), n = d(e, t), a(e, e, t), { remove: function () { e.removeClass(t.selectMultiClass), n && e.unwrap() }, update: C } } }, { match: function (e) { return e.is("textarea") }, apply: function (e, t) { var n; return e.addClass(t.textareaClass), n = d(e, t), a(e, e, t), { remove: function () { e.removeClass(t.textareaClass), n && e.unwrap() }, update: C } } }]; m() && !v() && (H = !1), e.uniform = { defaults: { activeClass: "active", autoHide: !0, buttonClass: "button", checkboxClass: "checker", checkedClass: "checked", disabledClass: "disabled", eventNamespace: ".uniform", fileButtonClass: "action", fileButtonHtml: "Choose File", fileClass: "uploader", fileDefaultHtml: "No file selected", filenameClass: "filename", focusClass: "focus", hoverClass: "hover", idPrefix: "uniform", inputAddTypeAsClass: !0, inputClass: "uniform-input", radioClass: "radio", resetDefaultHtml: "Reset", resetSelector: !1, selectAutoWidth: !0, selectClass: "selector", selectMultiClass: "uniform-multiselect", submitDefaultHtml: "Submit", textareaClass: "uniform", useID: !0, wrapperClass: null }, elements: [] }, e.fn.uniform = function (t) { var n = this; return t = e.extend({}, e.uniform.defaults, t), x || (x = !0, f() && (H = !1)), H ? (t.resetSelector && e(t.resetSelector).mouseup(function () { window.setTimeout(function () { e.uniform.update(n) }, 10) }), this.each(function () { var n, s, a, i = e(this); if (i.data("uniformed")) return e.uniform.update(i), void 0; for (n = 0; A.length > n; n += 1) if (s = A[n], s.match(i, t)) return a = s.apply(i, t), i.data("uniformed", a), e.uniform.elements.push(i.get(0)), void 0 })) : this }, e.uniform.restore = e.fn.uniform.restore = function (n) { n === t && (n = e.uniform.elements), e(n).each(function () { var t, n, s = e(this); n = s.data("uniformed"), n && (n.remove(), t = e.inArray(this, e.uniform.elements), t >= 0 && e.uniform.elements.splice(t, 1), s.removeData("uniformed")) }) }, e.uniform.update = e.fn.uniform.update = function (n) { n === t && (n = e.uniform.elements), e(n).each(function () { var t, n = e(this); t = n.data("uniformed"), t && t.update(n, t.options) }) } })(jQuery);

/*TouchSwipe*/
;(function(a){if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],a)}else{a(jQuery)}}(function(e){var o="left",n="right",d="up",v="down",c="in",w="out",l="none",r="auto",k="swipe",s="pinch",x="tap",i="doubletap",b="longtap",A="horizontal",t="vertical",h="all",q=10,f="start",j="move",g="end",p="cancel",a="ontouchstart" in window,y="TouchSwipe";var m={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:true,triggerOnTouchLeave:false,allowPageScroll:"auto",fallbackToMouseEvents:true,excludedElements:"label, button, input, select, textarea, .noSwipe"};e.fn.swipe=function(D){var C=e(this),B=C.data(y);if(B&&typeof D==="string"){if(B[D]){return B[D].apply(this,Array.prototype.slice.call(arguments,1))}else{e.error("Method "+D+" does not exist on jQuery.swipe")}}else{if(!B&&(typeof D==="object"||!D)){return u.apply(this,arguments)}}return C};e.fn.swipe.defaults=m;e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:j,PHASE_END:g,PHASE_CANCEL:p};e.fn.swipe.directions={LEFT:o,RIGHT:n,UP:d,DOWN:v,IN:c,OUT:w};e.fn.swipe.pageScroll={NONE:l,HORIZONTAL:A,VERTICAL:t,AUTO:r};e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:h};function u(B){if(B&&(B.allowPageScroll===undefined&&(B.swipe!==undefined||B.swipeStatus!==undefined))){B.allowPageScroll=l}if(B.click!==undefined&&B.tap===undefined){B.tap=B.click}if(!B){B={}}B=e.extend({},e.fn.swipe.defaults,B);return this.each(function(){var D=e(this);var C=D.data(y);if(!C){C=new z(this,B);D.data(y,C)}})}function z(a0,aq){var av=(a||!aq.fallbackToMouseEvents),G=av?"touchstart":"mousedown",au=av?"touchmove":"mousemove",R=av?"touchend":"mouseup",P=av?null:"mouseleave",az="touchcancel";var ac=0,aL=null,Y=0,aX=0,aV=0,D=1,am=0,aF=0,J=null;var aN=e(a0);var W="start";var T=0;var aM=null;var Q=0,aY=0,a1=0,aa=0,K=0;var aS=null;try{aN.bind(G,aJ);aN.bind(az,a5)}catch(ag){e.error("events not supported "+G+","+az+" on jQuery.swipe")}this.enable=function(){aN.bind(G,aJ);aN.bind(az,a5);return aN};this.disable=function(){aG();return aN};this.destroy=function(){aG();aN.data(y,null);return aN};this.option=function(a8,a7){if(aq[a8]!==undefined){if(a7===undefined){return aq[a8]}else{aq[a8]=a7}}else{e.error("Option "+a8+" does not exist on jQuery.swipe.options")}return null};function aJ(a9){if(ax()){return}if(e(a9.target).closest(aq.excludedElements,aN).length>0){return}var ba=a9.originalEvent?a9.originalEvent:a9;var a8,a7=a?ba.touches[0]:ba;W=f;if(a){T=ba.touches.length}else{a9.preventDefault()}ac=0;aL=null;aF=null;Y=0;aX=0;aV=0;D=1;am=0;aM=af();J=X();O();if(!a||(T===aq.fingers||aq.fingers===h)||aT()){ae(0,a7);Q=ao();if(T==2){ae(1,ba.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}if(aq.swipeStatus||aq.pinchStatus){a8=L(ba,W)}}else{a8=false}if(a8===false){W=p;L(ba,W);return a8}else{ak(true)}return null}function aZ(ba){var bd=ba.originalEvent?ba.originalEvent:ba;if(W===g||W===p||ai()){return}var a9,a8=a?bd.touches[0]:bd;var bb=aD(a8);aY=ao();if(a){T=bd.touches.length}W=j;if(T==2){if(aX==0){ae(1,bd.touches[1]);aX=aV=ap(aM[0].start,aM[1].start)}else{aD(bd.touches[1]);aV=ap(aM[0].end,aM[1].end);aF=an(aM[0].end,aM[1].end)}D=a3(aX,aV);am=Math.abs(aX-aV)}if((T===aq.fingers||aq.fingers===h)||!a||aT()){aL=aH(bb.start,bb.end);ah(ba,aL);ac=aO(bb.start,bb.end);Y=aI();aE(aL,ac);if(aq.swipeStatus||aq.pinchStatus){a9=L(bd,W)}if(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave){var a7=true;if(aq.triggerOnTouchLeave){var bc=aU(this);a7=B(bb.end,bc)}if(!aq.triggerOnTouchEnd&&a7){W=ay(j)}else{if(aq.triggerOnTouchLeave&&!a7){W=ay(g)}}if(W==p||W==g){L(bd,W)}}}else{W=p;L(bd,W)}if(a9===false){W=p;L(bd,W)}}function I(a7){var a8=a7.originalEvent;if(a){if(a8.touches.length>0){C();return true}}if(ai()){T=aa}a7.preventDefault();aY=ao();Y=aI();if(a6()){W=p;L(a8,W)}else{if(aq.triggerOnTouchEnd||(aq.triggerOnTouchEnd==false&&W===j)){W=g;L(a8,W)}else{if(!aq.triggerOnTouchEnd&&a2()){W=g;aB(a8,W,x)}else{if(W===j){W=p;L(a8,W)}}}}ak(false);return null}function a5(){T=0;aY=0;Q=0;aX=0;aV=0;D=1;O();ak(false)}function H(a7){var a8=a7.originalEvent;if(aq.triggerOnTouchLeave){W=ay(g);L(a8,W)}}function aG(){aN.unbind(G,aJ);aN.unbind(az,a5);aN.unbind(au,aZ);aN.unbind(R,I);if(P){aN.unbind(P,H)}ak(false)}function ay(bb){var ba=bb;var a9=aw();var a8=aj();var a7=a6();if(!a9||a7){ba=p}else{if(a8&&bb==j&&(!aq.triggerOnTouchEnd||aq.triggerOnTouchLeave)){ba=g}else{if(!a8&&bb==g&&aq.triggerOnTouchLeave){ba=p}}}return ba}function L(a9,a7){var a8=undefined;if(F()||S()){a8=aB(a9,a7,k)}else{if((M()||aT())&&a8!==false){a8=aB(a9,a7,s)}}if(aC()&&a8!==false){a8=aB(a9,a7,i)}else{if(al()&&a8!==false){a8=aB(a9,a7,b)}else{if(ad()&&a8!==false){a8=aB(a9,a7,x)}}}if(a7===p){a5(a9)}if(a7===g){if(a){if(a9.touches.length==0){a5(a9)}}else{a5(a9)}}return a8}function aB(ba,a7,a9){var a8=undefined;if(a9==k){aN.trigger("swipeStatus",[a7,aL||null,ac||0,Y||0,T]);if(aq.swipeStatus){a8=aq.swipeStatus.call(aN,ba,a7,aL||null,ac||0,Y||0,T);if(a8===false){return false}}if(a7==g&&aR()){aN.trigger("swipe",[aL,ac,Y,T]);if(aq.swipe){a8=aq.swipe.call(aN,ba,aL,ac,Y,T);if(a8===false){return false}}switch(aL){case o:aN.trigger("swipeLeft",[aL,ac,Y,T]);if(aq.swipeLeft){a8=aq.swipeLeft.call(aN,ba,aL,ac,Y,T)}break;case n:aN.trigger("swipeRight",[aL,ac,Y,T]);if(aq.swipeRight){a8=aq.swipeRight.call(aN,ba,aL,ac,Y,T)}break;case d:aN.trigger("swipeUp",[aL,ac,Y,T]);if(aq.swipeUp){a8=aq.swipeUp.call(aN,ba,aL,ac,Y,T)}break;case v:aN.trigger("swipeDown",[aL,ac,Y,T]);if(aq.swipeDown){a8=aq.swipeDown.call(aN,ba,aL,ac,Y,T)}break}}}if(a9==s){aN.trigger("pinchStatus",[a7,aF||null,am||0,Y||0,T,D]);if(aq.pinchStatus){a8=aq.pinchStatus.call(aN,ba,a7,aF||null,am||0,Y||0,T,D);if(a8===false){return false}}if(a7==g&&a4()){switch(aF){case c:aN.trigger("pinchIn",[aF||null,am||0,Y||0,T,D]);if(aq.pinchIn){a8=aq.pinchIn.call(aN,ba,aF||null,am||0,Y||0,T,D)}break;case w:aN.trigger("pinchOut",[aF||null,am||0,Y||0,T,D]);if(aq.pinchOut){a8=aq.pinchOut.call(aN,ba,aF||null,am||0,Y||0,T,D)}break}}}if(a9==x){if(a7===p||a7===g){clearTimeout(aS);if(V()&&!E()){K=ao();aS=setTimeout(e.proxy(function(){K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}},this),aq.doubleTapThreshold)}else{K=null;aN.trigger("tap",[ba.target]);if(aq.tap){a8=aq.tap.call(aN,ba,ba.target)}}}}else{if(a9==i){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("doubletap",[ba.target]);if(aq.doubleTap){a8=aq.doubleTap.call(aN,ba,ba.target)}}}else{if(a9==b){if(a7===p||a7===g){clearTimeout(aS);K=null;aN.trigger("longtap",[ba.target]);if(aq.longTap){a8=aq.longTap.call(aN,ba,ba.target)}}}}}return a8}function aj(){var a7=true;if(aq.threshold!==null){a7=ac>=aq.threshold}return a7}function a6(){var a7=false;if(aq.cancelThreshold!==null&&aL!==null){a7=(aP(aL)-ac)>=aq.cancelThreshold}return a7}function ab(){if(aq.pinchThreshold!==null){return am>=aq.pinchThreshold}return true}function aw(){var a7;if(aq.maxTimeThreshold){if(Y>=aq.maxTimeThreshold){a7=false}else{a7=true}}else{a7=true}return a7}function ah(a7,a8){if(aq.allowPageScroll===l||aT()){a7.preventDefault()}else{var a9=aq.allowPageScroll===r;switch(a8){case o:if((aq.swipeLeft&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case n:if((aq.swipeRight&&a9)||(!a9&&aq.allowPageScroll!=A)){a7.preventDefault()}break;case d:if((aq.swipeUp&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break;case v:if((aq.swipeDown&&a9)||(!a9&&aq.allowPageScroll!=t)){a7.preventDefault()}break}}}function a4(){var a8=aK();var a7=U();var a9=ab();return a8&&a7&&a9}function aT(){return !!(aq.pinchStatus||aq.pinchIn||aq.pinchOut)}function M(){return !!(a4()&&aT())}function aR(){var ba=aw();var bc=aj();var a9=aK();var a7=U();var a8=a6();var bb=!a8&&a7&&a9&&bc&&ba;return bb}function S(){return !!(aq.swipe||aq.swipeStatus||aq.swipeLeft||aq.swipeRight||aq.swipeUp||aq.swipeDown)}function F(){return !!(aR()&&S())}function aK(){return((T===aq.fingers||aq.fingers===h)||!a)}function U(){return aM[0].end.x!==0}function a2(){return !!(aq.tap)}function V(){return !!(aq.doubleTap)}function aQ(){return !!(aq.longTap)}function N(){if(K==null){return false}var a7=ao();return(V()&&((a7-K)<=aq.doubleTapThreshold))}function E(){return N()}function at(){return((T===1||!a)&&(isNaN(ac)||ac===0))}function aW(){return((Y>aq.longTapThreshold)&&(ac<q))}function ad(){return !!(at()&&a2())}function aC(){return !!(N()&&V())}function al(){return !!(aW()&&aQ())}function C(){a1=ao();aa=event.touches.length+1}function O(){a1=0;aa=0}function ai(){var a7=false;if(a1){var a8=ao()-a1;if(a8<=aq.fingerReleaseThreshold){a7=true}}return a7}function ax(){return !!(aN.data(y+"_intouch")===true)}function ak(a7){if(a7===true){aN.bind(au,aZ);aN.bind(R,I);if(P){aN.bind(P,H)}}else{aN.unbind(au,aZ,false);aN.unbind(R,I,false);if(P){aN.unbind(P,H,false)}}aN.data(y+"_intouch",a7===true)}function ae(a8,a7){var a9=a7.identifier!==undefined?a7.identifier:0;aM[a8].identifier=a9;aM[a8].start.x=aM[a8].end.x=a7.pageX||a7.clientX;aM[a8].start.y=aM[a8].end.y=a7.pageY||a7.clientY;return aM[a8]}function aD(a7){var a9=a7.identifier!==undefined?a7.identifier:0;var a8=Z(a9);a8.end.x=a7.pageX||a7.clientX;a8.end.y=a7.pageY||a7.clientY;return a8}function Z(a8){for(var a7=0;a7<aM.length;a7++){if(aM[a7].identifier==a8){return aM[a7]}}}function af(){var a7=[];for(var a8=0;a8<=5;a8++){a7.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0})}return a7}function aE(a7,a8){a8=Math.max(a8,aP(a7));J[a7].distance=a8}function aP(a7){if(J[a7]){return J[a7].distance}return undefined}function X(){var a7={};a7[o]=ar(o);a7[n]=ar(n);a7[d]=ar(d);a7[v]=ar(v);return a7}function ar(a7){return{direction:a7,distance:0}}function aI(){return aY-Q}function ap(ba,a9){var a8=Math.abs(ba.x-a9.x);var a7=Math.abs(ba.y-a9.y);return Math.round(Math.sqrt(a8*a8+a7*a7))}function a3(a7,a8){var a9=(a8/a7)*1;return a9.toFixed(2)}function an(){if(D<1){return w}else{return c}}function aO(a8,a7){return Math.round(Math.sqrt(Math.pow(a7.x-a8.x,2)+Math.pow(a7.y-a8.y,2)))}function aA(ba,a8){var a7=ba.x-a8.x;var bc=a8.y-ba.y;var a9=Math.atan2(bc,a7);var bb=Math.round(a9*180/Math.PI);if(bb<0){bb=360-Math.abs(bb)}return bb}function aH(a8,a7){var a9=aA(a8,a7);if((a9<=45)&&(a9>=0)){return o}else{if((a9<=360)&&(a9>=315)){return o}else{if((a9>=135)&&(a9<=225)){return n}else{if((a9>45)&&(a9<135)){return v}else{return d}}}}}function ao(){var a7=new Date();return a7.getTime()}function aU(a7){a7=e(a7);var a9=a7.offset();var a8={left:a9.left,right:a9.left+a7.outerWidth(),top:a9.top,bottom:a9.top+a7.outerHeight()};return a8}function B(a7,a8){return(a7.x>a8.left&&a7.x<a8.right&&a7.y>a8.top&&a7.y<a8.bottom)}}}));

/*ImgageLoader*/
; (function (c, n) {
    var l = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="; c.fn.imagesLoaded = function (f) {
        function m() { var b = c(i), a = c(h); d && (h.length ? d.reject(e, b, a) : d.resolve(e)); c.isFunction(f) && f.call(g, e, b, a) } function j(b, a) { b.src === l || -1 !== c.inArray(b, k) || (k.push(b), a ? h.push(b) : i.push(b), c.data(b, "imagesLoaded", { isBroken: a, src: b.src }), o && d.notifyWith(c(b), [a, e, c(i), c(h)]), e.length === k.length && (setTimeout(m), e.unbind(".imagesLoaded"))) } var g = this, d = c.isFunction(c.Deferred) ? c.Deferred() :
        0, o = c.isFunction(d.notify), e = g.find("img").add(g.filter("img")), k = [], i = [], h = []; c.isPlainObject(f) && c.each(f, function (b, a) { if ("callback" === b) f = a; else if (d) d[b](a) }); e.length ? e.bind("load.imagesLoaded error.imagesLoaded", function (b) { j(b.target, "error" === b.type) }).each(function (b, a) { var d = a.src, e = c.data(a, "imagesLoaded"); if (e && e.src === d) j(a, e.isBroken); else if (a.complete && a.naturalWidth !== n) j(a, 0 === a.naturalWidth || 0 === a.naturalHeight); else if (a.readyState || a.complete) a.src = l, a.src = d }) : m(); return d ? d.promise(g) :
        g
    }
})(jQuery);

/* Detectar Mobile*/
;function detectmob(){if(navigator.userAgent.match(/Touch/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}}

/* Detectar Browser*/
jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else if(browser.webkit){browser.safari=true}jQuery.browser=browser;

/*jquery.autofix_anything.js v1 */
!function($){

  var defaults = {
    customOffset: false,
    widthContent: false,
    manual: false,
    onlyInContainer: true
	};

  $.fn.autofix_anything = function(options){
    var settings = $.extend({}, defaults, options),
        el = $(this),
        curpos = el.position(),
        offset = settings.customOffset,
        widthfix = settings.widthContent,
        pos = el.parent().offset();

    el.addClass("autofix_sb")

    $.fn.manualfix = function () {
        var el = $(this),
            pos = el.offset();
        if (el.hasClass("fixed")) {
            el.removeClass("fixed")
        } else {
            el.addClass("fixed").css({
                top: 122,
                left: pos.left,
                right: "auto",
                bottom: "auto"
            });
        }
    }

    fixAll = function (el, settings, curpos, pos) {
      if (settings.customOffset == false) offset =  el.parent().offset().top - 142
      if($(document).scrollTop() > offset && $(document).scrollTop() <= (el.parent().height() + (offset - $(window).height())))  {
          el.removeClass("bottom").addClass("fixed").css({
            top: 142,
            left: el.parent().offset().left,
            right: "auto",
            bottom: "auto",
            width: $(settings.widthContent).width()
          });
      } else {
        if($(document).scrollTop() > offset) {
          if (settings.onlyInContainer == true ) {
            if($(document).scrollTop() > (el.parent().height() - $(window).height())) {
              el.addClass("bottom fixed").removeAttr( 'style' ).css({
                left: curpos.left
              });
            }else {
              el.removeClass("bottom fixed").removeAttr( 'style' );

            }
          }
        } else {
          el.removeClass("bottom fixed").removeAttr( 'style' );
        }
      }

    }
    if (settings.manual == false) {
      $(window).scroll(function() {
        fixAll(el, settings, curpos, pos)
      });
    }
  }
}(window.jQuery);

if(!detectmob()) {
  document.write('<script src="https://static.cinepolis.com/scripts/jquery-nicescroll.js"></script>');
}


;(function($,sr){

	// debouncing function from John Hann
	// http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/
	var debounce = function (func, threshold, execAsap) {
		var timeout;

		return function debounced () {
			var obj = this, args = arguments;
			function delayed () {
				if (!execAsap)
					func.apply(obj, args);
				timeout = null;
			};

			if (timeout)
				clearTimeout(timeout);
			else if (execAsap)
				func.apply(obj, args);

			timeout = setTimeout(delayed, threshold || 100);
		};
	}

	// smartresize
	jQuery.fn[sr] = function(fn){  return fn ? this.bind('resize', debounce(fn)) : this.trigger(sr); };

})(jQuery,'smartresize');
