
function route(url) {
    $.Url = /localhost/.test(document.URL) ? location.protocol + '//' + location.host + '/' : location.protocol + '//' + location.host + '/realidad-virtual/';
    return $.Url + url;
}



(function () {



	if (location.hash === '#juegos') {
		$trigger = $('#chooseGame');

		setTimeout(function () {
			$trigger.trigger('click');
		}, 2000);

	} 
	
})(); 


(function () {

	$carousel 	= $('.jcarousel'),
	$prevCtrl 	= $('.carousel-left'),
	$nextCtrl 	= $('.carousel-right');

	$carousel.jcarousel({
				wrap: 'circular'
			}).jcarouselSwipe();

	$prevCtrl.jcarouselControl({
		target: '-=1'
	});

	$nextCtrl.jcarouselControl({
		target: '+=1'
	});

})();



// 	// Selectors
	var $loader = $('.purchase-loader');


	function loading () {
		$loader.fadeIn();
	}

	function loaded () {
		$loader.fadeOut();
	}








//https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena14.jpg

(function () {

			// galleries
		$('#gallery').click(function() {
			$.fancybox.open([
				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-01.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-02.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-03.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-04.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-05.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-06.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-07.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-08.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-09.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-10.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-11.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-12.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-13.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-14.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-15.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-16.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-17.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-18.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/gallery-19.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena1.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena2.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena3.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena4.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena5.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena6.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena7.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena8.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena9.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena10.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena11.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena12.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena13.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena14.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena15.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena16.jpg'
				},

				{
					src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/arena17.jpg'
				},

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby1.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby2.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby3.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby4.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby5.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby6.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby7.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby8.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby9.jpg'
				// },

				// {
				// 	src: 'https://static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/gallery/lobby10.jpg'
				// }
			], {
				loop : true,
				hash : "gallery"
			});
		});




})();






var LoaderModule = (function() {

	'use strict';

	// selectors
	var $mainLoader = $('.vr-mainloader'),
			$initElements = $('.vr-mainloader__logo, .vr-mainloader__copy, .vr-mainloader__particles'),
			$loaderCopy = $('.vr-mainloader__copy'),
			$loaderProgress = $('.vr-mainloader__progress'),
			isMobile = $(window).innerWidth() <= 1024;

	// REVEAL
	return {
		init: init,
		loaded: loaded,
		setMessage: setMessage,
		setProgress: setProgress
	};

	/////////////////// LOGIC

	// PUBLIC
	function init () {
		$initElements.addClass('js-show');
	}

	function loaded () {
		$mainLoader.fadeOut('slow');
	}

	function setMessage (message) {
		$loaderCopy.text(message);
	}

	function setProgress (progress) {
		$loaderProgress.show();
		$loaderProgress.text(progress + '%');
	}




})();


var PurchaseLoader = (function() {

	'use strict';

	// selectors
	var $mainLoader = $('purchase-loader');

	// REVEAL
	return {
		init: init,
		loaded: loaded
	};

	/////////////////// LOGIC

	// PUBLIC
	function init () {
		$mainLoader.addClass('showLoader');
	}

	function loaded () {
		$mainLoader.fadeOut('slow').removeClass('showLoader');
	}

})();


	LoaderModule.init()

	$(window).load(function(){
		setTimeout(function() {
			LoaderModule.loaded();
		}, 2000);
	});


var $salesSlideHo = $('.sales-slider'),
		$salesSlide = '';

(function () {
	var $recommend  = $('#recommend'),
		$sales      = $('#sales'),
		$location   = $('#location'),
		$overlay    = $('.overlay'),
		$recommendP = $('.recommend'),
		$salesP     = $('.sales'),
		$locationP  = $('.location'),
		$back		= $('.back-L, .back-R, .back-C'),
		$backGame	= $('.back-G'),
		$game 		= $('.game'),
		$showGame 	= $('.slider'),
		$area = $('.ap-ov-area'),

		showPanel 	= function(el){
						el.toggleClass('active');
						$overlay.fadeIn(150);
					},

		hidePanel	= function(){
						$locationP.removeClass('active');
						$salesP.removeClass('active');
						$recommendP.removeClass('active');
						$overlay.fadeOut(150);
						if (!isMobile.any()) {
							$area.removeClass('ap-ov-area--active')
						}
					};

	$recommend.on('click', function(){
		showPanel($recommendP);
		$salesP.removeClass('active');
		$locationP.removeClass('active');
	});

	$sales.on('click', function(){
		showPanel($salesP);
		$recommendP.removeClass('active');
		$locationP.removeClass('active');
		if (!isMobile.any()) {
			$area.toggleClass('ap-ov-area--active');
		}
	});

	$location.on('click', function(){
		showPanel($locationP);
		$recommendP.removeClass('active');
		$salesP.removeClass('active');
	});

	$back.on('click', function(){
		hidePanel();
	});

	$overlay.on('click', function(){
		hidePanel();
	});


	if ( isMobile.any() ) {

			$showGame.on('click', '.slide.swiper-slide-active', function(){
				$game.addClass('show');
			})

	} else {

		$showGame.on('click', '.slide', function(){
			$game.addClass('show');
		})

	}


	$showGame.on('click', '.slide.swiper-slide-active', function(){
		$game.addClass('show');
	})

	$backGame.on('click', function(){
		$game.removeClass('show');
		CustomSelect.resetState($('select'));
	});
	slideDesk();
})();

function slideDesk() {
	if (!isMobile.any()) {
		$salesSlide = '<div class="swiper-container ap-ov-slider">' +
				'<div class="swiper-wrapper">' +
					'<div class="slide swiper-sl"><img src="//static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/sales-gal/img-slide-01.jpg" alt=""></div>' +
					'<div class="slide swiper-sl"><img src="//static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/sales-gal/img-slide-02.jpg" alt=""></div>' +
					'<div class="slide swiper-sl"><img src="//static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/sales-gal/img-slide-03.jpg" alt=""></div>' +
					'<div class="slide swiper-sl"><img src="//static.cinepolis.com/marcas/realidad-virtual/Resources/Content/img/sales-gal/img-slide-04.jpg" alt=""></div>' +
				'</div>' +
				// '<div class="swiper-button-next"></div>' +
				// '<div class="swiper-button-prev"></div>' +
			'</div>';

		$salesSlideHo.append($salesSlide);
	}
}

function runSld() {
	var swiper = new Swiper('.ap-ov-slider', {
				init: false,
				slideClass: 'swiper-sl',
				navigation: {
					nextEl: '.swiper-button-next',
					prevEl: '.swiper-button-prev',
				},
	      on: {
	      	init: function() {
	      		swiper.autoplay.start();
	      	}
	      }
	    });
}

$(document).ready(function(){
	if ($('.ap-ov-slider').is(':visible')) {
		runSld();
	}
});

(function () {

	var $homeNav  	= $('.nav-first'),
			$inNav			= $('.nav-second'),
			$trigger 		= $('#chooseGame'),
			$exit				= $('.exit'),

			switchNav 	= function(){
										$homeNav.toggleClass('active');
										$inNav.toggleClass('active');
										};

	$trigger.on('click', function(){
		switchNav();
	});

	$exit.on('click', function(){
		switchNav();
	});

})();





(function () {
})();

var CustomSelect = (function() {

	// selectors
	var $ctrl 			= $('.select-control'),
			$select 		= $('.select'),
			$dateCard 	= $('.carousel-list'),
			$carousel 	= $('#purchase-date'),
			$desc 			= $('.game-description-content'),
			$timeGrid 	= $('#purchase-time');

	// Bind events
	$ctrl.on('change', function() {
		var target = $(this);
		_onChangeCtrl(target);
		scrollUp($desc, 100, 'slow');
		
	});

	$dateCard.on('click', '.carousel-card', function(){
		$timeGrid.addClass('showGrid').removeClass('hideGrid');
		scrollUp($desc, 300, 'slow');
		PurchaseLoader.loaded();
	})

	if ($ctrl.find('option').length == 2) {
		$ctrl.css('display', 'none');
		$select.html($ctrl.find('option:last').text()).addClass('single');
		$carousel.addClass('showBlock').removeClass('hideBlock');
	} 


// 	// REVEAL
	return {
		resetState: resetState
	};

// 	/////////////////////// LOGIC

// 	// PUBLIC
	function resetState (target) {
		target.find('option:selected').prop("selected", false);
		target.find('option:first').prop("selected", "selected").trigger('change');
	}

// 	// PRIVATE
	function _onChangeCtrl (target) {
		_validateSelectedOption($ctrl, target.val());
	}

	function  scrollUp(target, px, speed){
		target.animate({
			scrollTop: px }, speed);
	}


	function _validateSelectedOption (valueSelector, value) {

		if (value == '') {
			valueSelector.addClass('no-select');
			$carousel.addClass('hideBlock').removeClass('showBlock');
			$timeGrid.addClass('hideGrid').removeClass('showGrid');

		} else {
			valueSelector.removeClass('no-select');
			$carousel.addClass('showBlock').removeClass('hideBlock');
			PurchaseLoader.loaded();
		}

	}

})();


			

var $slider;

(function () {
	
	var $trigger 			= $('#chooseGame'),
			$sliderCont 	= $('.slider'),
			$header 			= $('.header'),
			$headerH 			= $header.outerHeight(true),
			$videoDOM     = $('#video-home'),
			$video 				= $videoDOM.get(0),
			$exit					= $('.exit');


	if (isMobile.any()) {

		$sliderCont.addClass('mobile');
		$('body').addClass('mobile');

		$videoDOM.remove();

		$slider = new Swiper('.swiper-container', {
							effect: 						'coverflow',
							centeredSlides: 		true,
							slidesPerView: 			'auto',
							touchEventsTarget: 'wrapper',
							runCallbacksOnInit: true,
							loop: 							true,
							loopedSlides:       5,
							coverflowEffect: {
								rotate: 50,
								stretch: 0,
								depth: 100,
								modifier: 1,
								slideShadows : true
							}
					});

		if ($('.slider').hasClass('loaded')) {
			$slider.update();
		} 
		

		
	} else {
		$sliderCont.addClass('desktop');
		$('body').addClass('desktop');
	}

	$trigger.on('click', function(){
		$header.addClass('header--top');

		if (!isMobile.any()) {
				$video.pause();
			}
		
		$videoDOM.addClass('pause');

		
		$sliderCont.addClass('visible').fadeIn(800, function(){
			if (isMobile.any()) {
				$slider.update();
			} 
		});
	});


	$exit.on('click', function(){
		window.location.hash = '';
		$header.removeClass('visible').removeClass('header--top');
		$sliderCont.fadeOut(200);
		if (!isMobile.any()) {
				$video.play();
			}
	
		$videoDOM.removeClass('pause');
	});

	if (!isMobile.any()) {
		$('.slider.desktop .swiper-container').perfectScrollbar();
		$('.scroll').perfectScrollbar();
	}

	$('.purchase-time-grid.scroll').perfectScrollbar();
			
})(); 
